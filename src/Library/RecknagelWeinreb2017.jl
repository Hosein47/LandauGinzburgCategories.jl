"""
Orbifold equivalences from

> Andreas Recknagel, Paul Weinreb
> "Orbifold equivalence: structure and new examples."
> arXiv preprint arXiv:1708.08359 (2017).

The authors graciously made these orbifold equivalences available
in a machine-readable way at
    https://nms.kcl.ac.uk/andreas.recknagel/oeq-page/defectslistforweb.txt
"""

import PolynomialRings: Ideal, base_extend

import ..OrbifoldEquivalence: materialize_ansatz

function _orbifold_equivalence_def(f::Type{TwoVariables.A₂A₂}, g::Type{TwoVariables.A₅}, left_vars, right_vars)
    C = Complex{Int}
    R = @ring! C[α, β][x,y,u,v]

    # compatibility with copy-pasted notation below
    A = [α, β]
    lookup = Dict(1:4 .=> (u,im*v,x,y)) # note sign difference in convention for A₅

    Q = zeros(R, 4, 4)
    let a(i) = A[i], x(i) = lookup[i], (/,//) = (//,/)
        # from https://nms.kcl.ac.uk/andreas.recknagel/oeq-page/defectslistforweb.txt
        Q[1,3]=x(1)^2-x(3)*a(2)-x(4)*a(2)
        Q[1,4]=x(1)*x(3)*a(1)-x(1)*x(4)*a(1)+x(2)
        Q[2,3]=-x(1)*x(3)*a(1)+x(1)*x(4)*a(1)+x(2)
        Q[2,4]=-64*x(4)^2*a(2)^8+16*x(3)*x(4)*a(2)^5-x(1)^4-x(1)^2*x(3)*a(2)-x(1)^2*x(4)*a(2)-4*x(3)^2*a(2)^2
        Q[3,1]=64*x(4)^2*a(2)^8-16*x(3)*x(4)*a(2)^5+x(1)^4+x(1)^2*x(3)*a(2)+x(1)^2*x(4)*a(2)+4*x(3)^2*a(2)^2
        Q[3,2]=x(1)*x(3)*a(1)-x(1)*x(4)*a(1)+x(2)
        Q[4,1]=-x(1)*x(3)*a(1)+x(1)*x(4)*a(1)+x(2)
        Q[4,2]=-x(1)^2+x(3)*a(2)+x(4)*a(2)
    end

    Q = materialize_ansatz(Q, g(u,v) - f(x,y), :x, :y, :u, :v)

    # express in the user's variables
    Q = Q(x=left_vars[1], y=left_vars[2], u=right_vars[1], v=right_vars[2])

    return Q
end

function _orbifold_equivalence_def(f::Type{TwoVariables.D₇}, g::Type{TwoVariables.E₆}, left_vars, right_vars)
    R = @ring! ℚ[a[]][x,y,u,v]

    # compatibility with copy-pasted notation below
    A = a
    lookup = Dict(1:4 .=> (u,v,-x,y)) # note sign difference in convention for D₇

    Q = zeros(R, 6, 6)
    let a(i) = A[i], x(i) = lookup[i], (/,//) = (//,/)
        # from https://nms.kcl.ac.uk/andreas.recknagel/oeq-page/defectslistforweb.txt
        Q[1,4]=(2*a(1)-a(2)^2)*x(3)
        Q[1,5]=x(2)
        Q[1,6]=(2*a(1)^2-a(1)*a(2)^2)*x(3)^2+x(1)
        Q[2,4]=x(2)
        Q[2,5]=-x(3)^2+x(1)
        Q[2,6]=(-a(2))*x(4)
        Q[3,4]=(2*a(1)^2-3*a(1)*a(2)^2+a(2)^4+1)*x(3)^2+x(1)
        Q[3,5]=(a(2))*x(4)
        Q[3,6]=(-2*a(1)+a(2)^2)*x(3)^3+x(2)^2+(2*a(1)-a(2)^2)*x(1)*x(3)
        Q[4,1]=(-2*a(1)+a(2)^2)*x(3)^5+x(2)^2*x(3)^2+(4*a(1)-2*a(2)^2)*x(1)*x(3)^3-x(1)*x(2)^2+(-2*a(1)+a(2)^2)*x(1)^2*x(3)+(-a(2)^2)*x(4)^2
        Q[4,2]=(-2*a(1)+a(2)^2)*x(2)*x(3)^3+x(2)^3+(2*a(1)-a(2)^2)*x(1)*x(2)*x(3)+(-2*a(1)^2*a(2)+3*a(1)*a(2)^3-a(2)^5-a(2))*x(3)^2*x(4)+(-a(2))*x(1)*x(4)
        Q[4,3]=(-2*a(1)^2+a(1)*a(2)^2)*x(3)^4+(2*a(1)^2-a(1)*a(2)^2-1)*x(1)*x(3)^2+x(1)^2+(a(2))*x(2)*x(4)
        Q[5,1]=(-2*a(1)+a(2)^2)*x(2)*x(3)^3+x(2)^3+(2*a(1)-a(2)^2)*x(1)*x(2)*x(3)+(2*a(1)^2*a(2)-a(1)*a(2)^3)*x(3)^2*x(4)+(a(2))*x(1)*x(4)
        Q[5,2]=(4*a(1)^4-8*a(1)^3*a(2)^2+5*a(1)^2*a(2)^4+6*a(1)^2-a(1)*a(2)^6-5*a(1)*a(2)^2+a(2)^4)*x(3)^4+(-2*a(1)+a(2)^2)*x(2)^2*x(3)+x(1)*x(3)^2+x(1)^2
        Q[5,3]=(-2*a(1)^2+a(1)*a(2)^2)*x(2)*x(3)^2-x(1)*x(2)+(-2*a(1)*a(2)+a(2)^3)*x(3)*x(4)
        Q[6,1]=(-4*a(1)^4+8*a(1)^3*a(2)^2-5*a(1)^2*a(2)^4-8*a(1)^2+a(1)*a(2)^6+8*a(1)*a(2)^2-2*a(2)^4)*x(3)^4+(2*a(1)^2-3*a(1)*a(2)^2+a(2)^4)*x(1)*x(3)^2+x(1)^2+(-a(2))*x(2)*x(4)
        Q[6,2]=(-2*a(1)^2+3*a(1)*a(2)^2-a(2)^4-1)*x(2)*x(3)^2-x(1)*x(2)+(2*a(1)*a(2)-a(2)^3)*x(3)*x(4)
        Q[6,3]=(2*a(1)-a(2)^2)*x(3)^3+x(2)^2+(-2*a(1)+a(2)^2)*x(1)*x(3)
    end

    Q = materialize_ansatz(Q, g(u,v) - f(x,y), :x, :y, :u, :v)

    # express in the user's variables
    Q = Q(x=left_vars[1], y=left_vars[2], u=right_vars[1], v=right_vars[2])

    return Q
end

function _orbifold_equivalence_def(f::Type{TwoVariables.D₁₀}, g::Type{TwoVariables.E₇}, left_vars, right_vars)
    R = @ring! ℚ[a[]][x,y,u,v]

    # compatibility with copy-pasted notation below
    A = a
    lookup = Dict(1:4 .=> (u,v,-x,y)) # note sign difference in convention for D₇

    Q = zeros(R, 4, 4)
    let a(i) = A[i], x(i) = lookup[i], (/,//) = (//,/)
        # from https://nms.kcl.ac.uk/andreas.recknagel/oeq-page/defectslistforweb.txt
        Q[1,3]=(-a(1)^3-2*a(1)*a(2))*x(3)^3+(a(1))*x(2)*x(3)+x(1)
        Q[1,4]=(-3/2*a(1)^5-3*a(1)^3*a(2)-1/2*a(1)*a(2)^2)*x(3)^4+(-a(1)*a(2))*x(2)*x(3)^2+(a(1))*x(2)^2+(a(1)*a(3))*x(4)
        Q[2,3]=(-3/2*a(1)^4-3*a(1)^2*a(2)-1/2*a(2)^2)*x(3)^5+(-a(2))*x(2)*x(3)^3+x(2)^2*x(3)+(-a(3))*x(3)*x(4)
        Q[2,4]=(a(1)^6+4*a(1)^4*a(2)+4*a(1)^2*a(2)^2)*x(3)^6+(-2*a(1)^4-4*a(1)^2*a(2))*x(2)*x(3)^4+(a(1)^2)*x(2)^2*x(3)^2+(a(1)^3+2*a(1)*a(2))*x(1)*x(3)^3+x(2)^3+(-a(1))*x(1)*x(2)*x(3)+x(1)^2
        Q[3,1]=(a(1)^6+4*a(1)^4*a(2)+4*a(1)^2*a(2)^2)*x(3)^6+(-2*a(1)^4-4*a(1)^2*a(2))*x(2)*x(3)^4+(a(1)^2)*x(2)^2*x(3)^2+(a(1)^3+2*a(1)*a(2))*x(1)*x(3)^3+x(2)^3+(-a(1))*x(1)*x(2)*x(3)+x(1)^2
        Q[3,2]=(3/2*a(1)^5+3*a(1)^3*a(2)+1/2*a(1)*a(2)^2)*x(3)^4+(a(1)*a(2))*x(2)*x(3)^2+(-a(1))*x(2)^2+(-a(1)*a(3))*x(4)
        Q[4,1]=(3/2*a(1)^4+3*a(1)^2*a(2)+1/2*a(2)^2)*x(3)^5+(a(2))*x(2)*x(3)^3-x(2)^2*x(3)+(a(3))*x(3)*x(4)
        Q[4,2]=(-a(1)^3-2*a(1)*a(2))*x(3)^3+(a(1))*x(2)*x(3)+x(1)
    end

    Q = materialize_ansatz(Q, g(u,v) - f(x,y), :x, :y, :u, :v)

    # express in the user's variables
    Q = Q(x=left_vars[1], y=left_vars[2], u=right_vars[1], v=right_vars[2])

    return Q
end

function _orbifold_equivalence_def(f::Type{TwoVariables.D₁₆}, g::Type{TwoVariables.E₈}, left_vars, right_vars)
    #error("It's wiser not to use this equivalence... the computation doesn't terminate.")
    R = @ring! ℚ[a[1:5]][x,y,u,v]

    # compatibility with copy-pasted notation below
    A = a
    lookup = Dict(1:4 .=> (u,v,x,y))

    Q = zeros(R, 6, 6)
    let a(i) = A[i], x(i) = lookup[i], (/,//) = (//,/)
        # from https://nms.kcl.ac.uk/andreas.recknagel/oeq-page/defectslistforweb.txt
        Q[1,1]=0;
        Q[1,2]=0;
        Q[1,3]=0;
        Q[1,4]=(-a(1))*x(3);
        Q[1,5]=(-a(3))*x(3)^3+x(2);
        Q[1,6]=(-a(1)^2)*x(2)*x(3)^2+x(1);
        Q[2,1]=0;
        Q[2,2]=0;
        Q[2,3]=0;
        Q[2,4]=(1/2*a(1)^3+a(1)*a(2)^2*a(3)-1/2*a(1)*a(2)^2*a(4)-a(3)+a(4))*x(3)^3-x(2);
        Q[2,5]=(1/4*a(1)^5+1/2*a(1)^2*a(3)-3/2*a(1)^2*a(4)-2*a(2)^2*a(3)^2+5/2*a(2)^2*a(3)*a(4)-3/4*a(2)^2*a(4)^2)*x(3)^5+(-1/2*a(1)^2-a(2)^2*a(3)+1/2*a(2)^2*a(4))*x(2)*x(3)^2+x(1);
        Q[2,6]=(-7/8*a(1)^7-1/4*a(1)^5*a(2)^2*a(3)+1/8*a(1)^5*a(2)^2*a(4)+1/4*a(1)^4*a(3)+11/2*a(1)^4*a(4)+1/2*a(1)^3*a(2)^4*a(3)^2-1/2*a(1)^3*a(2)^4*a(3)*a(4)+1/8*a(1)^3*a(2)^4*a(4)^2+7*a(1)^2*a(2)^2*a(3)^2-6*a(1)^2*a(2)^2*a(3)*a(4)+5/4*a(1)^2*a(2)^2*a(4)^2+a(1)*a(2)^6*a(3)^3-3/2*a(1)*a(2)^6*a(3)^2*a(4)+3/4*a(1)*a(2)^6*a(3)*a(4)^2-1/8*a(1)*a(2)^6*a(4)^3-2*a(1)*a(3)^2-a(1)*a(4)^2-a(2)^4*a(3)^3+a(2)^4*a(3)^2*a(4)-1/4*a(2)^4*a(3)*a(4)^2+a(4)*a(5))*x(3)^7+(3/4*a(1)^4+a(1)^2*a(2)^2*a(3)-1/2*a(1)^2*a(2)^2*a(4)-a(1)*a(3)-a(1)*a(4)-a(2)^4*a(3)^2+a(2)^4*a(3)*a(4)-1/4*a(2)^4*a(4)^2)*x(2)*x(3)^4+(-a(1))*x(2)^2*x(3)+(-a(1)^2)*x(1)*x(3)^2+(a(2))*x(4);
        Q[3,1]=0;
        Q[3,2]=0;
        Q[3,3]=0;
        Q[3,4]=(-1/4*a(1)^5+1/2*a(1)^2*a(3)+3/2*a(1)^2*a(4)-a(1)*a(5)+2*a(2)^2*a(3)^2-5/2*a(2)^2*a(3)*a(4)+3/4*a(2)^2*a(4)^2)*x(3)^5+(1/2*a(1)^2+a(2)^2*a(3)-1/2*a(2)^2*a(4))*x(2)*x(3)^2+x(1);
        Q[3,5]=(-1/4*a(1)^7-1/2*a(1)^5*a(2)^2*a(3)+1/4*a(1)^5*a(2)^2*a(4)+3/2*a(1)^4*a(4)+2*a(1)^2*a(2)^2*a(3)^2+1/2*a(1)^2*a(2)^2*a(3)*a(4)-3/4*a(1)^2*a(2)^2*a(4)^2+4*a(2)^4*a(3)^3-7*a(2)^4*a(3)^2*a(4)+4*a(2)^4*a(3)*a(4)^2-3/4*a(2)^4*a(4)^3-a(3)*a(5)+a(4)*a(5))*x(3)^7+(a(5))*x(2)*x(3)^4+(a(2))*x(4);
        Q[3,6]=(1/2*a(1)^9+a(1)^7*a(2)^2*a(3)-1/2*a(1)^7*a(2)^2*a(4)-1/8*a(1)^6*a(3)-17/4*a(1)^6*a(4)-1/4*a(1)^5*a(2)^4*a(3)^2+1/4*a(1)^5*a(2)^4*a(3)*a(4)-1/16*a(1)^5*a(2)^4*a(4)^2-4*a(1)^4*a(2)^2*a(3)^2-17/8*a(1)^4*a(2)^2*a(3)*a(4)+33/16*a(1)^4*a(2)^2*a(4)^2-a(1)^3*a(2)^6*a(3)^3+3/2*a(1)^3*a(2)^6*a(3)^2*a(4)-3/4*a(1)^3*a(2)^6*a(3)*a(4)^2+1/8*a(1)^3*a(2)^6*a(4)^3+a(1)^3*a(3)^2+15/2*a(1)^3*a(4)^2-13/2*a(1)^2*a(2)^4*a(3)^3+11*a(1)^2*a(2)^4*a(3)^2*a(4)-49/8*a(1)^2*a(2)^4*a(3)*a(4)^2+9/8*a(1)^2*a(2)^4*a(4)^3-1/2*a(1)^2*a(4)*a(5)-a(1)*a(2)^8*a(3)^4+2*a(1)*a(2)^8*a(3)^3*a(4)-3/2*a(1)*a(2)^8*a(3)^2*a(4)^2+1/2*a(1)*a(2)^8*a(3)*a(4)^3-1/16*a(1)*a(2)^8*a(4)^4+2*a(1)*a(2)^2*a(3)^3+7*a(1)*a(2)^2*a(3)^2*a(4)-7*a(1)*a(2)^2*a(3)*a(4)^2+3/2*a(1)*a(2)^2*a(4)^3+2*a(2)^6*a(3)^4-7/2*a(2)^6*a(3)^3*a(4)+9/4*a(2)^6*a(3)^2*a(4)^2-5/8*a(2)^6*a(3)*a(4)^3+1/16*a(2)^6*a(4)^4-a(2)^2*a(3)*a(4)*a(5)+1/2*a(2)^2*a(4)^2*a(5)-2*a(3)^2*a(4)+2*a(3)*a(4)^2-a(4)^3)*x(3)^9+(-5/8*a(1)^6-1/4*a(1)^4*a(2)^2*a(3)+1/8*a(1)^4*a(2)^2*a(4)+1/2*a(1)^3*a(3)+4*a(1)^3*a(4)+1/2*a(1)^2*a(2)^4*a(3)^2-1/2*a(1)^2*a(2)^4*a(3)*a(4)+1/8*a(1)^2*a(2)^4*a(4)^2-a(1)^2*a(5)+5*a(1)*a(2)^2*a(3)^2-7/2*a(1)*a(2)^2*a(3)*a(4)+1/2*a(1)*a(2)^2*a(4)^2+a(2)^6*a(3)^3-3/2*a(2)^6*a(3)^2*a(4)+3/4*a(2)^6*a(3)*a(4)^2-1/8*a(2)^6*a(4)^3-a(3)^2+a(3)*a(4)-a(4)^2)*x(2)*x(3)^6+(1/2*a(1)^3+a(1)*a(2)^2*a(3)-1/2*a(1)*a(2)^2*a(4)-a(4))*x(2)^2*x(3)^3+(a(5))*x(1)*x(3)^4-x(2)^3+(-1/2*a(1)^2*a(2)-a(2)^3*a(3)+1/2*a(2)^3*a(4))*x(3)^2*x(4);
        Q[4,1]=(3/32*a(1)^14+1/4*a(1)^12*a(2)^2*a(3)-1/8*a(1)^12*a(2)^2*a(4)-9/32*a(1)^11*a(3)-7/8*a(1)^11*a(4)+1/16*a(1)^10*a(2)^4*a(3)^2-1/16*a(1)^10*a(2)^4*a(3)*a(4)+1/64*a(1)^10*a(2)^4*a(4)^2-17/8*a(1)^9*a(2)^2*a(3)^2-31/32*a(1)^9*a(2)^2*a(3)*a(4)+65/64*a(1)^9*a(2)^2*a(4)^2-1/4*a(1)^8*a(2)^6*a(3)^3+3/8*a(1)^8*a(2)^6*a(3)^2*a(4)-3/16*a(1)^8*a(2)^6*a(3)*a(4)^2+1/32*a(1)^8*a(2)^6*a(4)^3+5/16*a(1)^8*a(3)^2+37/16*a(1)^8*a(3)*a(4)+1/4*a(1)^8*a(4)^2-7/2*a(1)^7*a(2)^4*a(3)^3+19/4*a(1)^7*a(2)^4*a(3)^2*a(4)-17/8*a(1)^7*a(2)^4*a(3)*a(4)^2+5/16*a(1)^7*a(2)^4*a(4)^3+7/8*a(1)^7*a(3)*a(5)-a(1)^7*a(4)*a(5)-1/4*a(1)^6*a(2)^8*a(3)^4+1/2*a(1)^6*a(2)^8*a(3)^3*a(4)-3/8*a(1)^6*a(2)^8*a(3)^2*a(4)^2+1/8*a(1)^6*a(2)^8*a(3)*a(4)^3-1/64*a(1)^6*a(2)^8*a(4)^4+11/4*a(1)^6*a(2)^2*a(3)^3+25/4*a(1)^6*a(2)^2*a(3)^2*a(4)+17/8*a(1)^6*a(2)^2*a(3)*a(4)^2-95/32*a(1)^6*a(2)^2*a(4)^3+2*a(1)^5*a(2)^6*a(3)^3*a(4)-3*a(1)^5*a(2)^6*a(3)^2*a(4)^2+3/2*a(1)^5*a(2)^6*a(3)*a(4)^3-1/4*a(1)^5*a(2)^6*a(4)^4+1/4*a(1)^5*a(2)^2*a(3)^2*a(5)-5/8*a(1)^5*a(2)^2*a(3)*a(4)*a(5)+1/4*a(1)^5*a(2)^2*a(4)^2*a(5)-1/2*a(1)^5*a(3)^3-a(1)^5*a(3)^2*a(4)-17/4*a(1)^5*a(3)*a(4)^2+10*a(1)^5*a(4)^3+41/4*a(1)^4*a(2)^4*a(3)^4+3/4*a(1)^4*a(2)^4*a(3)^3*a(4)-63/4*a(1)^4*a(2)^4*a(3)^2*a(4)^2+161/16*a(1)^4*a(2)^4*a(3)*a(4)^3-117/64*a(1)^4*a(2)^4*a(4)^4-1/4*a(1)^4*a(3)^2*a(5)-5*a(1)^4*a(3)*a(4)*a(5)+25/4*a(1)^4*a(4)^2*a(5)+5/2*a(1)^3*a(2)^8*a(3)^5-5*a(1)^3*a(2)^8*a(3)^4*a(4)+15/4*a(1)^3*a(2)^8*a(3)^3*a(4)^2-5/4*a(1)^3*a(2)^8*a(3)^2*a(4)^3+5/32*a(1)^3*a(2)^8*a(3)*a(4)^4-1/2*a(1)^3*a(2)^4*a(3)^3*a(5)+a(1)^3*a(2)^4*a(3)^2*a(4)*a(5)-5/8*a(1)^3*a(2)^4*a(3)*a(4)^2*a(5)+1/8*a(1)^3*a(2)^4*a(4)^3*a(5)-3*a(1)^3*a(2)^2*a(3)^4-4*a(1)^3*a(2)^2*a(3)^3*a(4)+117/4*a(1)^3*a(2)^2*a(3)^2*a(4)^2-61/2*a(1)^3*a(2)^2*a(3)*a(4)^3+69/8*a(1)^3*a(2)^2*a(4)^4+12*a(1)^2*a(2)^6*a(3)^5-57/2*a(1)^2*a(2)^6*a(3)^4*a(4)+99/4*a(1)^2*a(2)^6*a(3)^3*a(4)^2-75/8*a(1)^2*a(2)^6*a(3)^2*a(4)^3+21/16*a(1)^2*a(2)^6*a(3)*a(4)^4-7*a(1)^2*a(2)^2*a(3)^3*a(5)+29/2*a(1)^2*a(2)^2*a(3)^2*a(4)*a(5)-29/4*a(1)^2*a(2)^2*a(3)*a(4)^2*a(5)+7/8*a(1)^2*a(2)^2*a(4)^3*a(5)+a(1)^2*a(3)^3*a(4)-4*a(1)^2*a(3)^2*a(4)^2+7/2*a(1)^2*a(3)*a(4)^3-3/2*a(1)^2*a(4)^4+2*a(1)*a(2)^10*a(3)^6-13/2*a(1)*a(2)^10*a(3)^5*a(4)+35/4*a(1)*a(2)^10*a(3)^4*a(4)^2-25/4*a(1)*a(2)^10*a(3)^3*a(4)^3+5/2*a(1)*a(2)^10*a(3)^2*a(4)^4-17/32*a(1)*a(2)^10*a(3)*a(4)^5+3/64*a(1)*a(2)^10*a(4)^6-a(1)*a(2)^6*a(3)^4*a(5)+5/2*a(1)*a(2)^6*a(3)^3*a(4)*a(5)-9/4*a(1)*a(2)^6*a(3)^2*a(4)^2*a(5)+7/8*a(1)*a(2)^6*a(3)*a(4)^3*a(5)-1/8*a(1)*a(2)^6*a(4)^4*a(5)-4*a(1)*a(2)^4*a(3)^5+23*a(1)*a(2)^4*a(3)^4*a(4)-42*a(1)*a(2)^4*a(3)^3*a(4)^2+137/4*a(1)*a(2)^4*a(3)^2*a(4)^3-13*a(1)*a(2)^4*a(3)*a(4)^4+15/8*a(1)*a(2)^4*a(4)^5+2*a(1)*a(3)^3*a(5)-2*a(1)*a(3)^2*a(4)*a(5)+a(1)*a(3)*a(4)^2*a(5)-a(1)*a(4)^3*a(5)-a(2)^8*a(3)^5*a(4)+11/4*a(2)^8*a(3)^4*a(4)^2-3*a(2)^8*a(3)^3*a(4)^3+13/8*a(2)^8*a(3)^2*a(4)^4-7/16*a(2)^8*a(3)*a(4)^5+3/64*a(2)^8*a(4)^6+a(2)^4*a(3)^4*a(5)-9/4*a(2)^4*a(3)^2*a(4)^2*a(5)+7/4*a(2)^4*a(3)*a(4)^3*a(5)-3/8*a(2)^4*a(4)^4*a(5)-4*a(2)^2*a(3)^4*a(4)+9*a(2)^2*a(3)^3*a(4)^2-17/2*a(2)^2*a(3)^2*a(4)^3+4*a(2)^2*a(3)*a(4)^4-3/4*a(2)^2*a(4)^5-a(3)*a(4)*a(5)^2+a(4)^2*a(5)^2)*x(3)^14+(7/32*a(1)^11+7/16*a(1)^9*a(2)^2*a(3)-7/32*a(1)^9*a(2)^2*a(4)+3/8*a(1)^8*a(3)-43/16*a(1)^8*a(4)+1/2*a(1)^7*a(2)^4*a(3)^2-1/2*a(1)^7*a(2)^4*a(3)*a(4)+1/8*a(1)^7*a(2)^4*a(4)^2-5/8*a(1)^7*a(5)-5/2*a(1)^6*a(2)^2*a(3)^2-9/8*a(1)^6*a(2)^2*a(3)*a(4)+19/16*a(1)^6*a(2)^2*a(4)^2-1/2*a(1)^5*a(2)^6*a(3)^3+3/4*a(1)^5*a(2)^6*a(3)^2*a(4)-3/8*a(1)^5*a(2)^6*a(3)*a(4)^2+1/16*a(1)^5*a(2)^6*a(4)^3-1/4*a(1)^5*a(2)^2*a(3)*a(5)+1/8*a(1)^5*a(2)^2*a(4)*a(5)+1/2*a(1)^5*a(3)^2-3*a(1)^5*a(3)*a(4)+17/2*a(1)^5*a(4)^2-3*a(1)^4*a(2)^4*a(3)^3+9/4*a(1)^4*a(2)^4*a(3)*a(4)^2-3/4*a(1)^4*a(2)^4*a(4)^3+9/2*a(1)^4*a(4)*a(5)-3/2*a(1)^3*a(2)^8*a(3)^4+3*a(1)^3*a(2)^8*a(3)^3*a(4)-9/4*a(1)^3*a(2)^8*a(3)^2*a(4)^2+3/4*a(1)^3*a(2)^8*a(3)*a(4)^3-3/32*a(1)^3*a(2)^8*a(4)^4+1/2*a(1)^3*a(2)^4*a(3)^2*a(5)-1/2*a(1)^3*a(2)^4*a(3)*a(4)*a(5)+1/8*a(1)^3*a(2)^4*a(4)^2*a(5)-3/2*a(1)^3*a(2)^2*a(3)^3+33/2*a(1)^3*a(2)^2*a(3)^2*a(4)-87/8*a(1)^3*a(2)^2*a(3)*a(4)^2+3/2*a(1)^3*a(2)^2*a(4)^3-3*a(1)^2*a(2)^6*a(3)^4+5*a(1)^2*a(2)^6*a(3)^3*a(4)-3*a(1)^2*a(2)^6*a(3)^2*a(4)^2+3/4*a(1)^2*a(2)^6*a(3)*a(4)^3-1/16*a(1)^2*a(2)^6*a(4)^4+4*a(1)^2*a(2)^2*a(3)^2*a(5)-3*a(1)^2*a(2)^2*a(3)*a(4)*a(5)+1/2*a(1)^2*a(2)^2*a(4)^2*a(5)+1/2*a(1)^2*a(3)^3-3*a(1)^2*a(3)^2*a(4)+3*a(1)^2*a(3)*a(4)^2-2*a(1)^2*a(4)^3-a(1)*a(2)^10*a(3)^5+5/2*a(1)*a(2)^10*a(3)^4*a(4)-5/2*a(1)*a(2)^10*a(3)^3*a(4)^2+5/4*a(1)*a(2)^10*a(3)^2*a(4)^3-5/16*a(1)*a(2)^10*a(3)*a(4)^4+1/32*a(1)*a(2)^10*a(4)^5+a(1)*a(2)^6*a(3)^3*a(5)-3/2*a(1)*a(2)^6*a(3)^2*a(4)*a(5)+3/4*a(1)*a(2)^6*a(3)*a(4)^2*a(5)-1/8*a(1)*a(2)^6*a(4)^3*a(5)+8*a(1)*a(2)^4*a(3)^4-21/2*a(1)*a(2)^4*a(3)^3*a(4)+6*a(1)*a(2)^4*a(3)^2*a(4)^2-17/8*a(1)*a(2)^4*a(3)*a(4)^3+3/8*a(1)*a(2)^4*a(4)^4-a(1)*a(3)^2*a(5)-2*a(1)*a(4)^2*a(5)+a(2)^8*a(3)^4*a(4)-2*a(2)^8*a(3)^3*a(4)^2+3/2*a(2)^8*a(3)^2*a(4)^3-1/2*a(2)^8*a(3)*a(4)^4+1/16*a(2)^8*a(4)^5-2*a(2)^4*a(3)^2*a(4)*a(5)+2*a(2)^4*a(3)*a(4)^2*a(5)-1/2*a(2)^4*a(4)^3*a(5)-2*a(2)^2*a(3)^4+5/2*a(2)^2*a(3)^3*a(4)-9/4*a(2)^2*a(3)^2*a(4)^2+5/4*a(2)^2*a(3)*a(4)^3-1/4*a(2)^2*a(4)^4+a(4)*a(5)^2)*x(2)*x(3)^11+(-3/16*a(1)^8-1/2*a(1)^6*a(2)^2*a(3)+1/4*a(1)^6*a(2)^2*a(4)+3/2*a(1)^5*a(4)+1/4*a(1)^4*a(5)+3/2*a(1)^3*a(2)^2*a(3)^2+2*a(1)^3*a(2)^2*a(3)*a(4)-11/8*a(1)^3*a(2)^2*a(4)^2+a(1)^2*a(2)^6*a(3)^3-3/2*a(1)^2*a(2)^6*a(3)^2*a(4)+3/4*a(1)^2*a(2)^6*a(3)*a(4)^2-1/8*a(1)^2*a(2)^6*a(4)^3-1/2*a(1)^2*a(3)^2+a(1)^2*a(3)*a(4)-2*a(1)^2*a(4)^2+3*a(1)*a(2)^4*a(3)^3-5/2*a(1)*a(2)^4*a(3)^2*a(4)+1/4*a(1)*a(2)^4*a(3)*a(4)^2+1/8*a(1)*a(2)^4*a(4)^3-2*a(1)*a(4)*a(5)+a(2)^8*a(3)^4-2*a(2)^8*a(3)^3*a(4)+3/2*a(2)^8*a(3)^2*a(4)^2-1/2*a(2)^8*a(3)*a(4)^3+1/16*a(2)^8*a(4)^4-a(2)^4*a(3)^2*a(5)+a(2)^4*a(3)*a(4)*a(5)-1/4*a(2)^4*a(4)^2*a(5)-a(2)^2*a(3)^3-1/2*a(2)^2*a(3)^2*a(4)+a(2)^2*a(3)*a(4)^2-1/4*a(2)^2*a(4)^3)*x(2)^2*x(3)^8+(-1/4*a(1)^9-1/2*a(1)^7*a(2)^2*a(3)+1/4*a(1)^7*a(2)^2*a(4)+1/8*a(1)^6*a(3)+11/4*a(1)^6*a(4)+1/4*a(1)^5*a(2)^4*a(3)^2-1/4*a(1)^5*a(2)^4*a(3)*a(4)+1/16*a(1)^5*a(2)^4*a(4)^2-1/4*a(1)^5*a(5)+2*a(1)^4*a(2)^2*a(3)^2+13/8*a(1)^4*a(2)^2*a(3)*a(4)-21/16*a(1)^4*a(2)^2*a(4)^2+a(1)^3*a(2)^6*a(3)^3-3/2*a(1)^3*a(2)^6*a(3)^2*a(4)+3/4*a(1)^3*a(2)^6*a(3)*a(4)^2-1/8*a(1)^3*a(2)^6*a(4)^3-a(1)^3*a(3)^2-15/2*a(1)^3*a(4)^2+5/2*a(1)^2*a(2)^4*a(3)^3-4*a(1)^2*a(2)^4*a(3)^2*a(4)+17/8*a(1)^2*a(2)^4*a(3)*a(4)^2-3/8*a(1)^2*a(2)^4*a(4)^3+1/2*a(1)^2*a(3)*a(5)+a(1)^2*a(4)*a(5)+a(1)*a(2)^8*a(3)^4-2*a(1)*a(2)^8*a(3)^3*a(4)+3/2*a(1)*a(2)^8*a(3)^2*a(4)^2-1/2*a(1)*a(2)^8*a(3)*a(4)^3+1/16*a(1)*a(2)^8*a(4)^4-2*a(1)*a(2)^2*a(3)^3-7*a(1)*a(2)^2*a(3)^2*a(4)+7*a(1)*a(2)^2*a(3)*a(4)^2-3/2*a(1)*a(2)^2*a(4)^3-2*a(2)^6*a(3)^4+7/2*a(2)^6*a(3)^3*a(4)-9/4*a(2)^6*a(3)^2*a(4)^2+5/8*a(2)^6*a(3)*a(4)^3-1/16*a(2)^6*a(4)^4+2*a(2)^2*a(3)^2*a(5)-3/2*a(2)^2*a(3)*a(4)*a(5)+1/4*a(2)^2*a(4)^2*a(5)+2*a(3)^2*a(4)-2*a(3)*a(4)^2+a(4)^3)*x(1)*x(3)^9+(1/2*a(1)^5+a(1)^3*a(2)^2*a(3)-1/2*a(1)^3*a(2)^2*a(4)+1/2*a(1)^2*a(3)-2*a(1)^2*a(4)+a(1)*a(2)^4*a(3)^2-a(1)*a(2)^4*a(3)*a(4)+1/4*a(1)*a(2)^4*a(4)^2-a(1)*a(5)-2*a(2)^2*a(3)^2+3/2*a(2)^2*a(3)*a(4)-1/4*a(2)^2*a(4)^2)*x(2)^3*x(3)^5+(5/8*a(1)^6+1/4*a(1)^4*a(2)^2*a(3)-1/8*a(1)^4*a(2)^2*a(4)-1/2*a(1)^3*a(3)-4*a(1)^3*a(4)-1/2*a(1)^2*a(2)^4*a(3)^2+1/2*a(1)^2*a(2)^4*a(3)*a(4)-1/8*a(1)^2*a(2)^4*a(4)^2+1/2*a(1)^2*a(5)-5*a(1)*a(2)^2*a(3)^2+7/2*a(1)*a(2)^2*a(3)*a(4)-1/2*a(1)*a(2)^2*a(4)^2-a(2)^6*a(3)^3+3/2*a(2)^6*a(3)^2*a(4)-3/4*a(2)^6*a(3)*a(4)^2+1/8*a(2)^6*a(4)^3+a(2)^2*a(3)*a(5)-1/2*a(2)^2*a(4)*a(5)+a(3)^2-a(3)*a(4)+a(4)^2)*x(1)*x(2)*x(3)^6+(-a(1)^7*a(2)-1/2*a(1)^5*a(2)^3*a(3)+1/4*a(1)^5*a(2)^3*a(4)+1/2*a(1)^4*a(2)*a(3)+25/4*a(1)^4*a(2)*a(4)+1/2*a(1)^3*a(2)^5*a(3)^2-1/2*a(1)^3*a(2)^5*a(3)*a(4)+1/8*a(1)^3*a(2)^5*a(4)^2+17/2*a(1)^2*a(2)^3*a(3)^2-6*a(1)^2*a(2)^3*a(3)*a(4)+7/8*a(1)^2*a(2)^3*a(4)^2+a(1)*a(2)^7*a(3)^3-3/2*a(1)*a(2)^7*a(3)^2*a(4)+3/4*a(1)*a(2)^7*a(3)*a(4)^2-1/8*a(1)*a(2)^7*a(4)^3-2*a(1)*a(2)^3*a(3)*a(5)+a(1)*a(2)^3*a(4)*a(5)-2*a(1)*a(2)*a(3)^2-a(1)*a(2)*a(4)^2+a(2)^5*a(3)^3-5/2*a(2)^5*a(3)^2*a(4)+7/4*a(2)^5*a(3)*a(4)^2-3/8*a(2)^5*a(4)^3+a(2)*a(3)*a(5)+a(2)*a(4)*a(5))*x(3)^7*x(4)+(-1/2*a(1)^2-a(2)^2*a(3)+1/2*a(2)^2*a(4))*x(2)^4*x(3)^2+(-1/2*a(1)^3-a(1)*a(2)^2*a(3)+1/2*a(1)*a(2)^2*a(4)+a(4))*x(1)*x(2)^2*x(3)^3+(-a(5))*x(1)^2*x(3)^4+(1/2*a(1)^4*a(2)-a(1)*a(2)*a(3)-a(1)*a(2)*a(4)-2*a(2)^5*a(3)^2+2*a(2)^5*a(3)*a(4)-1/2*a(2)^5*a(4)^2+a(2)*a(5))*x(2)*x(3)^4*x(4)+x(1)*x(2)^3+(-a(1)*a(2))*x(2)^2*x(3)*x(4)+(-1/2*a(1)^2*a(2)+a(2)^3*a(3)-1/2*a(2)^3*a(4))*x(1)*x(3)^2*x(4)+(a(2)^2)*x(4)^2;
        Q[4,2]=(-1/2*a(1)^9*a(3)-a(1)^7*a(2)^2*a(3)^2+1/2*a(1)^7*a(2)^2*a(3)*a(4)+1/8*a(1)^6*a(3)^2+17/4*a(1)^6*a(3)*a(4)+1/4*a(1)^5*a(2)^4*a(3)^3-1/4*a(1)^5*a(2)^4*a(3)^2*a(4)+1/16*a(1)^5*a(2)^4*a(3)*a(4)^2+4*a(1)^4*a(2)^2*a(3)^3+17/8*a(1)^4*a(2)^2*a(3)^2*a(4)-33/16*a(1)^4*a(2)^2*a(3)*a(4)^2+a(1)^3*a(2)^6*a(3)^4-3/2*a(1)^3*a(2)^6*a(3)^3*a(4)+3/4*a(1)^3*a(2)^6*a(3)^2*a(4)^2-1/8*a(1)^3*a(2)^6*a(3)*a(4)^3-a(1)^3*a(3)^3-15/2*a(1)^3*a(3)*a(4)^2+13/2*a(1)^2*a(2)^4*a(3)^4-11*a(1)^2*a(2)^4*a(3)^3*a(4)+49/8*a(1)^2*a(2)^4*a(3)^2*a(4)^2-9/8*a(1)^2*a(2)^4*a(3)*a(4)^3+1/2*a(1)^2*a(3)*a(4)*a(5)+a(1)*a(2)^8*a(3)^5-2*a(1)*a(2)^8*a(3)^4*a(4)+3/2*a(1)*a(2)^8*a(3)^3*a(4)^2-1/2*a(1)*a(2)^8*a(3)^2*a(4)^3+1/16*a(1)*a(2)^8*a(3)*a(4)^4-2*a(1)*a(2)^2*a(3)^4-7*a(1)*a(2)^2*a(3)^3*a(4)+7*a(1)*a(2)^2*a(3)^2*a(4)^2-3/2*a(1)*a(2)^2*a(3)*a(4)^3-2*a(2)^6*a(3)^5+7/2*a(2)^6*a(3)^4*a(4)-9/4*a(2)^6*a(3)^3*a(4)^2+5/8*a(2)^6*a(3)^2*a(4)^3-1/16*a(2)^6*a(3)*a(4)^4+a(2)^2*a(3)^2*a(4)*a(5)-1/2*a(2)^2*a(3)*a(4)^2*a(5)+2*a(3)^3*a(4)-2*a(3)^2*a(4)^2+a(3)*a(4)^3)*x(3)^12+(1/4*a(1)^9+1/2*a(1)^7*a(2)^2*a(3)-1/4*a(1)^7*a(2)^2*a(4)+1/2*a(1)^6*a(3)-11/4*a(1)^6*a(4)-1/4*a(1)^5*a(2)^4*a(3)^2+1/4*a(1)^5*a(2)^4*a(3)*a(4)-1/16*a(1)^5*a(2)^4*a(4)^2-7/4*a(1)^4*a(2)^2*a(3)^2-7/4*a(1)^4*a(2)^2*a(3)*a(4)+21/16*a(1)^4*a(2)^2*a(4)^2-a(1)^3*a(2)^6*a(3)^3+3/2*a(1)^3*a(2)^6*a(3)^2*a(4)-3/4*a(1)^3*a(2)^6*a(3)*a(4)^2+1/8*a(1)^3*a(2)^6*a(4)^3+1/2*a(1)^3*a(3)^2-4*a(1)^3*a(3)*a(4)+15/2*a(1)^3*a(4)^2-3*a(1)^2*a(2)^4*a(3)^3+9/2*a(1)^2*a(2)^4*a(3)^2*a(4)-9/4*a(1)^2*a(2)^4*a(3)*a(4)^2+3/8*a(1)^2*a(2)^4*a(4)^3+1/2*a(1)^2*a(4)*a(5)-a(1)*a(2)^8*a(3)^4+2*a(1)*a(2)^8*a(3)^3*a(4)-3/2*a(1)*a(2)^8*a(3)^2*a(4)^2+1/2*a(1)*a(2)^8*a(3)*a(4)^3-1/16*a(1)*a(2)^8*a(4)^4-3*a(1)*a(2)^2*a(3)^3+21/2*a(1)*a(2)^2*a(3)^2*a(4)-15/2*a(1)*a(2)^2*a(3)*a(4)^2+3/2*a(1)*a(2)^2*a(4)^3+a(2)^6*a(3)^4-2*a(2)^6*a(3)^3*a(4)+3/2*a(2)^6*a(3)^2*a(4)^2-1/2*a(2)^6*a(3)*a(4)^3+1/16*a(2)^6*a(4)^4-a(2)^2*a(3)*a(4)*a(5)+1/2*a(2)^2*a(4)^2*a(5)+a(3)^3-3*a(3)^2*a(4)+3*a(3)*a(4)^2-a(4)^3)*x(2)*x(3)^9+(-5/8*a(1)^6-1/4*a(1)^4*a(2)^2*a(3)+1/8*a(1)^4*a(2)^2*a(4)+4*a(1)^3*a(4)+1/2*a(1)^2*a(2)^4*a(3)^2-1/2*a(1)^2*a(2)^4*a(3)*a(4)+1/8*a(1)^2*a(2)^4*a(4)^2+4*a(1)*a(2)^2*a(3)^2-3*a(1)*a(2)^2*a(3)*a(4)+1/2*a(1)*a(2)^2*a(4)^2+a(2)^6*a(3)^3-3/2*a(2)^6*a(3)^2*a(4)+3/4*a(2)^6*a(3)*a(4)^2-1/8*a(2)^6*a(4)^3-a(3)^2+2*a(3)*a(4)-a(4)^2)*x(2)^2*x(3)^6+(1/4*a(1)^7+1/2*a(1)^5*a(2)^2*a(3)-1/4*a(1)^5*a(2)^2*a(4)-3/2*a(1)^4*a(4)-2*a(1)^2*a(2)^2*a(3)^2-1/2*a(1)^2*a(2)^2*a(3)*a(4)+3/4*a(1)^2*a(2)^2*a(4)^2-4*a(2)^4*a(3)^3+7*a(2)^4*a(3)^2*a(4)-4*a(2)^4*a(3)*a(4)^2+3/4*a(2)^4*a(4)^3-a(4)*a(5))*x(1)*x(3)^7+(1/2*a(1)^3+a(1)*a(2)^2*a(3)-1/2*a(1)*a(2)^2*a(4)+a(3)-a(4))*x(2)^3*x(3)^3+(1/2*a(1)^2*a(2)*a(3)+a(2)^3*a(3)^2-1/2*a(2)^3*a(3)*a(4))*x(3)^5*x(4)-x(2)^4+(1/2*a(1)^2*a(2)-a(2)^3*a(3)+1/2*a(2)^3*a(4))*x(2)*x(3)^2*x(4)+(-a(2))*x(1)*x(4);
        Q[4,3]=(-7/8*a(1)^7*a(3)-1/4*a(1)^5*a(2)^2*a(3)^2+1/8*a(1)^5*a(2)^2*a(3)*a(4)+1/4*a(1)^4*a(3)^2+11/2*a(1)^4*a(3)*a(4)+1/2*a(1)^3*a(2)^4*a(3)^3-1/2*a(1)^3*a(2)^4*a(3)^2*a(4)+1/8*a(1)^3*a(2)^4*a(3)*a(4)^2+7*a(1)^2*a(2)^2*a(3)^3-6*a(1)^2*a(2)^2*a(3)^2*a(4)+5/4*a(1)^2*a(2)^2*a(3)*a(4)^2+a(1)*a(2)^6*a(3)^4-3/2*a(1)*a(2)^6*a(3)^3*a(4)+3/4*a(1)*a(2)^6*a(3)^2*a(4)^2-1/8*a(1)*a(2)^6*a(3)*a(4)^3-2*a(1)*a(3)^3-a(1)*a(3)*a(4)^2-a(2)^4*a(3)^4+a(2)^4*a(3)^3*a(4)-1/4*a(2)^4*a(3)^2*a(4)^2+a(3)*a(4)*a(5))*x(3)^10+(5/8*a(1)^7+1/4*a(1)^5*a(2)^2*a(3)-1/8*a(1)^5*a(2)^2*a(4)-4*a(1)^4*a(4)-1/2*a(1)^3*a(2)^4*a(3)^2+1/2*a(1)^3*a(2)^4*a(3)*a(4)-1/8*a(1)^3*a(2)^4*a(4)^2-4*a(1)^2*a(2)^2*a(3)^2+3*a(1)^2*a(2)^2*a(3)*a(4)-1/2*a(1)^2*a(2)^2*a(4)^2-a(1)*a(2)^6*a(3)^3+3/2*a(1)*a(2)^6*a(3)^2*a(4)-3/4*a(1)*a(2)^6*a(3)*a(4)^2+1/8*a(1)*a(2)^6*a(4)^3+a(1)*a(3)^2-a(1)*a(3)*a(4)+a(1)*a(4)^2-a(4)*a(5))*x(2)*x(3)^7+(-1/4*a(1)^4+a(1)*a(4)+a(2)^4*a(3)^2-a(2)^4*a(3)*a(4)+1/4*a(2)^4*a(4)^2)*x(2)^2*x(3)^4+(1/4*a(1)^5-1/2*a(1)^2*a(3)-3/2*a(1)^2*a(4)-2*a(2)^2*a(3)^2+5/2*a(2)^2*a(3)*a(4)-3/4*a(2)^2*a(4)^2)*x(1)*x(3)^5+(a(1))*x(2)^3*x(3)+(-1/2*a(1)^2-a(2)^2*a(3)+1/2*a(2)^2*a(4))*x(1)*x(2)*x(3)^2+(2*a(1)*a(2)^3*a(3)-a(1)*a(2)^3*a(4)-a(2)*a(3)+a(2)*a(4))*x(3)^3*x(4)+x(1)^2+(-a(2))*x(2)*x(4);
        Q[4,4]=0;
        Q[4,5]=0;
        Q[4,6]=0;
        Q[5,1]=(1/32*a(1)^12+15/16*a(1)^10*a(2)^2*a(3)-15/32*a(1)^10*a(2)^2*a(4)-1/16*a(1)^9*a(3)+17/16*a(1)^9*a(4)+a(1)^8*a(2)^4*a(3)^2-a(1)^8*a(2)^4*a(3)*a(4)+1/4*a(1)^8*a(2)^4*a(4)^2-7/8*a(1)^8*a(5)+1/2*a(1)^7*a(2)^2*a(3)^2-57/8*a(1)^7*a(2)^2*a(3)*a(4)+55/16*a(1)^7*a(2)^2*a(4)^2-1/2*a(1)^6*a(2)^6*a(3)^3+3/4*a(1)^6*a(2)^6*a(3)^2*a(4)-3/8*a(1)^6*a(2)^6*a(3)*a(4)^2+1/16*a(1)^6*a(2)^6*a(4)^3-1/4*a(1)^6*a(2)^2*a(3)*a(5)+1/8*a(1)^6*a(2)^2*a(4)*a(5)+a(1)^6*a(3)*a(4)-9*a(1)^6*a(4)^2-7*a(1)^5*a(2)^4*a(3)^3+15/4*a(1)^5*a(2)^4*a(3)^2*a(4)+3/2*a(1)^5*a(2)^4*a(3)*a(4)^2-13/16*a(1)^5*a(2)^4*a(4)^3+1/4*a(1)^5*a(3)*a(5)+11/2*a(1)^5*a(4)*a(5)-3/2*a(1)^4*a(2)^8*a(3)^4+3*a(1)^4*a(2)^8*a(3)^3*a(4)-9/4*a(1)^4*a(2)^8*a(3)^2*a(4)^2+3/4*a(1)^4*a(2)^8*a(3)*a(4)^3-3/32*a(1)^4*a(2)^8*a(4)^4+1/2*a(1)^4*a(2)^4*a(3)^2*a(5)-1/2*a(1)^4*a(2)^4*a(3)*a(4)*a(5)+1/8*a(1)^4*a(2)^4*a(4)^2*a(5)+2*a(1)^4*a(2)^2*a(3)^3-67/4*a(1)^4*a(2)^2*a(3)^2*a(4)+87/4*a(1)^4*a(2)^2*a(3)*a(4)^2-111/16*a(1)^4*a(2)^2*a(4)^3-6*a(1)^3*a(2)^6*a(3)^4+23/2*a(1)^3*a(2)^6*a(3)^3*a(4)-33/4*a(1)^3*a(2)^6*a(3)^2*a(4)^2+21/8*a(1)^3*a(2)^6*a(3)*a(4)^3-5/16*a(1)^3*a(2)^6*a(4)^4+7*a(1)^3*a(2)^2*a(3)^2*a(5)-7*a(1)^3*a(2)^2*a(3)*a(4)*a(5)+7/4*a(1)^3*a(2)^2*a(4)^2*a(5)+3*a(1)^3*a(3)^2*a(4)-6*a(1)^3*a(3)*a(4)^2+17/2*a(1)^3*a(4)^3-a(1)^2*a(2)^10*a(3)^5+5/2*a(1)^2*a(2)^10*a(3)^4*a(4)-5/2*a(1)^2*a(2)^10*a(3)^3*a(4)^2+5/4*a(1)^2*a(2)^10*a(3)^2*a(4)^3-5/16*a(1)^2*a(2)^10*a(3)*a(4)^4+1/32*a(1)^2*a(2)^10*a(4)^5+a(1)^2*a(2)^6*a(3)^3*a(5)-3/2*a(1)^2*a(2)^6*a(3)^2*a(4)*a(5)+3/4*a(1)^2*a(2)^6*a(3)*a(4)^2*a(5)-1/8*a(1)^2*a(2)^6*a(4)^3*a(5)-5*a(1)^2*a(2)^4*a(3)^4+19*a(1)^2*a(2)^4*a(3)^3*a(4)-35/2*a(1)^2*a(2)^4*a(3)^2*a(4)^2+23/4*a(1)^2*a(2)^4*a(3)*a(4)^3-9/16*a(1)^2*a(2)^4*a(4)^4-2*a(1)^2*a(3)^2*a(5)-3*a(1)^2*a(4)^2*a(5)+a(1)*a(2)^8*a(3)^5-2*a(1)*a(2)^8*a(3)^4*a(4)+3/2*a(1)*a(2)^8*a(3)^3*a(4)^2-1/2*a(1)*a(2)^8*a(3)^2*a(4)^3+1/16*a(1)*a(2)^8*a(3)*a(4)^4-a(1)*a(2)^4*a(3)^3*a(5)+3/4*a(1)*a(2)^4*a(3)*a(4)^2*a(5)-1/4*a(1)*a(2)^4*a(4)^3*a(5)+2*a(1)*a(2)^2*a(3)^4-12*a(1)*a(2)^2*a(3)^3*a(4)+41/2*a(1)*a(2)^2*a(3)^2*a(4)^2-13*a(1)*a(2)^2*a(3)*a(4)^3+11/4*a(1)*a(2)^2*a(4)^4+a(1)*a(4)*a(5)^2+a(2)^6*a(3)^4*a(4)-2*a(2)^6*a(3)^3*a(4)^2+3/2*a(2)^6*a(3)^2*a(4)^3-1/2*a(2)^6*a(3)*a(4)^4+1/16*a(2)^6*a(4)^5-a(2)^2*a(3)^2*a(4)*a(5)+a(2)^2*a(3)*a(4)^2*a(5)-1/4*a(2)^2*a(4)^3*a(5)+2*a(3)^3*a(4)-4*a(3)^2*a(4)^2+3*a(3)*a(4)^3-a(4)^4)*x(3)^12+(-3/16*a(1)^9-1/2*a(1)^7*a(2)^2*a(3)+1/4*a(1)^7*a(2)^2*a(4)+1/4*a(1)^6*a(3)+3/2*a(1)^6*a(4)+1/4*a(1)^5*a(5)+3/2*a(1)^4*a(2)^2*a(3)^2+2*a(1)^4*a(2)^2*a(3)*a(4)-11/8*a(1)^4*a(2)^2*a(4)^2+a(1)^3*a(2)^6*a(3)^3-3/2*a(1)^3*a(2)^6*a(3)^2*a(4)+3/4*a(1)^3*a(2)^6*a(3)*a(4)^2-1/8*a(1)^3*a(2)^6*a(4)^3-1/2*a(1)^3*a(3)^2-a(1)^3*a(3)*a(4)-2*a(1)^3*a(4)^2+3*a(1)^2*a(2)^4*a(3)^3-5/2*a(1)^2*a(2)^4*a(3)^2*a(4)+1/4*a(1)^2*a(2)^4*a(3)*a(4)^2+1/8*a(1)^2*a(2)^4*a(4)^3-2*a(1)^2*a(4)*a(5)+a(1)*a(2)^8*a(3)^4-2*a(1)*a(2)^8*a(3)^3*a(4)+3/2*a(1)*a(2)^8*a(3)^2*a(4)^2-1/2*a(1)*a(2)^8*a(3)*a(4)^3+1/16*a(1)*a(2)^8*a(4)^4-a(1)*a(2)^4*a(3)^2*a(5)+a(1)*a(2)^4*a(3)*a(4)*a(5)-1/4*a(1)*a(2)^4*a(4)^2*a(5)-4*a(1)*a(2)^2*a(3)^3+3/2*a(1)*a(2)^2*a(3)^2*a(4)+3/4*a(1)*a(2)^2*a(3)*a(4)^2-1/4*a(1)*a(2)^2*a(4)^3+a(3)^3)*x(2)*x(3)^9+(1/4*a(1)^6-2*a(1)^3*a(4)-3*a(1)*a(2)^2*a(3)^2+2*a(1)*a(2)^2*a(3)*a(4)-1/4*a(1)*a(2)^2*a(4)^2+a(3)^2)*x(2)^2*x(3)^6+(5/8*a(1)^7+1/4*a(1)^5*a(2)^2*a(3)-1/8*a(1)^5*a(2)^2*a(4)+1/4*a(1)^4*a(3)-4*a(1)^4*a(4)-1/2*a(1)^3*a(2)^4*a(3)^2+1/2*a(1)^3*a(2)^4*a(3)*a(4)-1/8*a(1)^3*a(2)^4*a(4)^2-1/2*a(1)^3*a(5)-5*a(1)^2*a(2)^2*a(3)^2+7/2*a(1)^2*a(2)^2*a(3)*a(4)-1/2*a(1)^2*a(2)^2*a(4)^2-a(1)*a(2)^6*a(3)^3+3/2*a(1)*a(2)^6*a(3)^2*a(4)-3/4*a(1)*a(2)^6*a(3)*a(4)^2+1/8*a(1)*a(2)^6*a(4)^3+a(1)*a(2)^2*a(3)*a(5)-1/2*a(1)*a(2)^2*a(4)*a(5)+2*a(1)*a(3)^2+a(1)*a(4)^2+a(2)^4*a(3)^3-a(2)^4*a(3)^2*a(4)+1/4*a(2)^4*a(3)*a(4)^2-a(3)*a(5))*x(1)*x(3)^7+(-1/2*a(1)^3-a(1)*a(2)^2*a(3)+1/2*a(1)*a(2)^2*a(4)+a(3))*x(2)^3*x(3)^3+(-1/4*a(1)^4+a(1)*a(3)+a(1)*a(4)+a(2)^4*a(3)^2-a(2)^4*a(3)*a(4)+1/4*a(2)^4*a(4)^2-a(5))*x(1)*x(2)*x(3)^4+(-a(1)^3*a(2)^3*a(3)+1/2*a(1)^3*a(2)^3*a(4)-2*a(1)^2*a(2)*a(4)-2*a(1)*a(2)^5*a(3)^2+2*a(1)*a(2)^5*a(3)*a(4)-1/2*a(1)*a(2)^5*a(4)^2+a(1)*a(2)*a(5))*x(3)^5*x(4)+x(2)^4+(a(1))*x(1)*x(2)^2*x(3)+(a(1)^2)*x(1)^2*x(3)^2+(-a(2))*x(1)*x(4);
        Q[5,2]=(1/2*a(1)^10+a(1)^8*a(2)^2*a(3)-1/2*a(1)^8*a(2)^2*a(4)-1/8*a(1)^7*a(3)-17/4*a(1)^7*a(4)-1/4*a(1)^6*a(2)^4*a(3)^2+1/4*a(1)^6*a(2)^4*a(3)*a(4)-1/16*a(1)^6*a(2)^4*a(4)^2-4*a(1)^5*a(2)^2*a(3)^2-17/8*a(1)^5*a(2)^2*a(3)*a(4)+33/16*a(1)^5*a(2)^2*a(4)^2-a(1)^4*a(2)^6*a(3)^3+3/2*a(1)^4*a(2)^6*a(3)^2*a(4)-3/4*a(1)^4*a(2)^6*a(3)*a(4)^2+1/8*a(1)^4*a(2)^6*a(4)^3+a(1)^4*a(3)^2+15/2*a(1)^4*a(4)^2-13/2*a(1)^3*a(2)^4*a(3)^3+11*a(1)^3*a(2)^4*a(3)^2*a(4)-49/8*a(1)^3*a(2)^4*a(3)*a(4)^2+9/8*a(1)^3*a(2)^4*a(4)^3-1/2*a(1)^3*a(4)*a(5)-a(1)^2*a(2)^8*a(3)^4+2*a(1)^2*a(2)^8*a(3)^3*a(4)-3/2*a(1)^2*a(2)^8*a(3)^2*a(4)^2+1/2*a(1)^2*a(2)^8*a(3)*a(4)^3-1/16*a(1)^2*a(2)^8*a(4)^4+2*a(1)^2*a(2)^2*a(3)^3+7*a(1)^2*a(2)^2*a(3)^2*a(4)-7*a(1)^2*a(2)^2*a(3)*a(4)^2+3/2*a(1)^2*a(2)^2*a(4)^3+2*a(1)*a(2)^6*a(3)^4-7/2*a(1)*a(2)^6*a(3)^3*a(4)+9/4*a(1)*a(2)^6*a(3)^2*a(4)^2-5/8*a(1)*a(2)^6*a(3)*a(4)^3+1/16*a(1)*a(2)^6*a(4)^4-a(1)*a(2)^2*a(3)*a(4)*a(5)+1/2*a(1)*a(2)^2*a(4)^2*a(5)-2*a(1)*a(3)^2*a(4)+2*a(1)*a(3)*a(4)^2-a(1)*a(4)^3)*x(3)^10+(-3/8*a(1)^7-1/4*a(1)^5*a(2)^2*a(3)+1/8*a(1)^5*a(2)^2*a(4)+5/2*a(1)^4*a(4)+1/2*a(1)^3*a(2)^4*a(3)^2-1/2*a(1)^3*a(2)^4*a(3)*a(4)+1/8*a(1)^3*a(2)^4*a(4)^2+3*a(1)^2*a(2)^2*a(3)^2-a(1)^2*a(2)^2*a(3)*a(4)-1/4*a(1)^2*a(2)^2*a(4)^2+a(1)*a(2)^6*a(3)^3-3/2*a(1)*a(2)^6*a(3)^2*a(4)+3/4*a(1)*a(2)^6*a(3)*a(4)^2-1/8*a(1)*a(2)^6*a(4)^3-a(1)*a(3)^2+a(1)*a(3)*a(4)-a(1)*a(4)^2)*x(2)*x(3)^7+(-a(1)*a(4))*x(2)^2*x(3)^4+(-1/4*a(1)^5+1/2*a(1)^2*a(3)+3/2*a(1)^2*a(4)+2*a(2)^2*a(3)^2-5/2*a(2)^2*a(3)*a(4)+3/4*a(2)^2*a(4)^2)*x(1)*x(3)^5+(-a(1))*x(2)^3*x(3)+(-1/2*a(1)^2+a(2)^2*a(3)-1/2*a(2)^2*a(4))*x(1)*x(2)*x(3)^2+(-1/2*a(1)^3*a(2)-a(1)*a(2)^3*a(3)+1/2*a(1)*a(2)^3*a(4))*x(3)^3*x(4)+x(1)^2;
        Q[5,3]=(7/8*a(1)^8+1/4*a(1)^6*a(2)^2*a(3)-1/8*a(1)^6*a(2)^2*a(4)-1/4*a(1)^5*a(3)-11/2*a(1)^5*a(4)-1/2*a(1)^4*a(2)^4*a(3)^2+1/2*a(1)^4*a(2)^4*a(3)*a(4)-1/8*a(1)^4*a(2)^4*a(4)^2-7*a(1)^3*a(2)^2*a(3)^2+6*a(1)^3*a(2)^2*a(3)*a(4)-5/4*a(1)^3*a(2)^2*a(4)^2-a(1)^2*a(2)^6*a(3)^3+3/2*a(1)^2*a(2)^6*a(3)^2*a(4)-3/4*a(1)^2*a(2)^6*a(3)*a(4)^2+1/8*a(1)^2*a(2)^6*a(4)^3+2*a(1)^2*a(3)^2+a(1)^2*a(4)^2+a(1)*a(2)^4*a(3)^3-a(1)*a(2)^4*a(3)^2*a(4)+1/4*a(1)*a(2)^4*a(3)*a(4)^2-a(1)*a(4)*a(5))*x(3)^8+(-1/4*a(1)^5+2*a(1)^2*a(4)+a(1)*a(2)^4*a(3)^2-a(1)*a(2)^4*a(3)*a(4)+1/4*a(1)*a(2)^4*a(4)^2)*x(2)*x(3)^5+(1/2*a(1)^3-a(1)*a(2)^2*a(3)+1/2*a(1)*a(2)^2*a(4)+a(3)-a(4))*x(1)*x(3)^3+x(1)*x(2)+(-a(1)*a(2))*x(3)*x(4);
        Q[5,4]=0;
        Q[5,5]=0;
        Q[5,6]=0;
        Q[6,1]=(-1/4*a(1)^10-1/2*a(1)^8*a(2)^2*a(3)+1/4*a(1)^8*a(2)^2*a(4)+3/4*a(1)^7*a(3)+11/4*a(1)^7*a(4)+1/4*a(1)^6*a(2)^4*a(3)^2-1/4*a(1)^6*a(2)^4*a(3)*a(4)+1/16*a(1)^6*a(2)^4*a(4)^2-1/4*a(1)^6*a(5)+9/4*a(1)^5*a(2)^2*a(3)^2+3/2*a(1)^5*a(2)^2*a(3)*a(4)-21/16*a(1)^5*a(2)^2*a(4)^2+a(1)^4*a(2)^6*a(3)^3-3/2*a(1)^4*a(2)^6*a(3)^2*a(4)+3/4*a(1)^4*a(2)^6*a(3)*a(4)^2-1/8*a(1)^4*a(2)^6*a(4)^3-3/4*a(1)^4*a(3)^2-4*a(1)^4*a(3)*a(4)-15/2*a(1)^4*a(4)^2+2*a(1)^3*a(2)^4*a(3)^3-7/2*a(1)^3*a(2)^4*a(3)^2*a(4)+2*a(1)^3*a(2)^4*a(3)*a(4)^2-3/8*a(1)^3*a(2)^4*a(4)^3+a(1)^3*a(4)*a(5)+a(1)^2*a(2)^8*a(3)^4-2*a(1)^2*a(2)^8*a(3)^3*a(4)+3/2*a(1)^2*a(2)^8*a(3)^2*a(4)^2-1/2*a(1)^2*a(2)^8*a(3)*a(4)^3+1/16*a(1)^2*a(2)^8*a(4)^4-7*a(1)^2*a(2)^2*a(3)^3-7/2*a(1)^2*a(2)^2*a(3)^2*a(4)+13/2*a(1)^2*a(2)^2*a(3)*a(4)^2-3/2*a(1)^2*a(2)^2*a(4)^3-3*a(1)*a(2)^6*a(3)^4+5*a(1)*a(2)^6*a(3)^3*a(4)-3*a(1)*a(2)^6*a(3)^2*a(4)^2+3/4*a(1)*a(2)^6*a(3)*a(4)^3-1/16*a(1)*a(2)^6*a(4)^4+3*a(1)*a(2)^2*a(3)^2*a(5)-2*a(1)*a(2)^2*a(3)*a(4)*a(5)+1/4*a(1)*a(2)^2*a(4)^2*a(5)+2*a(1)*a(3)^3+2*a(1)*a(3)^2*a(4)-a(1)*a(3)*a(4)^2+a(1)*a(4)^3+a(2)^4*a(3)^4-a(2)^4*a(3)^3*a(4)+1/4*a(2)^4*a(3)^2*a(4)^2-a(3)^2*a(5))*x(3)^10+(-1/4*a(1)^4-a(1)^2*a(2)^2*a(3)+1/2*a(1)^2*a(2)^2*a(4)-a(2)^4*a(3)^2+a(2)^4*a(3)*a(4)-1/4*a(2)^4*a(4)^2+a(5))*x(2)^2*x(3)^4+(a(1)^2*a(3)-a(1)*a(5))*x(1)*x(3)^5+(-1/2*a(1)^3*a(2)+a(1)*a(2)^3*a(3)-1/2*a(1)*a(2)^3*a(4)-a(2)*a(3))*x(3)^3*x(4)+x(1)^2+(a(2))*x(2)*x(4);
        Q[6,2]=(1/4*a(1)^8+1/2*a(1)^6*a(2)^2*a(3)-1/4*a(1)^6*a(2)^2*a(4)-1/4*a(1)^5*a(3)-3/2*a(1)^5*a(4)-2*a(1)^3*a(2)^2*a(3)^2-1/2*a(1)^3*a(2)^2*a(3)*a(4)+3/4*a(1)^3*a(2)^2*a(4)^2+1/2*a(1)^2*a(3)^2+3/2*a(1)^2*a(3)*a(4)-4*a(1)*a(2)^4*a(3)^3+7*a(1)*a(2)^4*a(3)^2*a(4)-4*a(1)*a(2)^4*a(3)*a(4)^2+3/4*a(1)*a(2)^4*a(4)^3-a(1)*a(4)*a(5)+2*a(2)^2*a(3)^3-5/2*a(2)^2*a(3)^2*a(4)+3/4*a(2)^2*a(3)*a(4)^2)*x(3)^8+(1/4*a(1)^5-3/2*a(1)^2*a(4)-a(2)^2*a(3)^2+2*a(2)^2*a(3)*a(4)-3/4*a(2)^2*a(4)^2)*x(2)*x(3)^5+(-1/2*a(1)^2-a(2)^2*a(3)+1/2*a(2)^2*a(4))*x(2)^2*x(3)^2+(a(3))*x(1)*x(3)^3-x(1)*x(2)+(-a(1)*a(2))*x(3)*x(4);
        Q[6,3]=(1/4*a(1)^6-3/2*a(1)^3*a(4)-3*a(1)*a(2)^2*a(3)^2+3*a(1)*a(2)^2*a(3)*a(4)-3/4*a(1)*a(2)^2*a(4)^2+a(3)^2-a(3)*a(4))*x(3)^6+(a(4))*x(2)*x(3)^3-x(2)^2+(a(1))*x(1)*x(3);
        Q[6,4]=0;
        Q[6,5]=0;
        Q[6,6]=0;
    end

    Q = materialize_ansatz(Q, g(u,v) - f(x,y), :x, :y, :u, :v)

    # express in the user's variables
    Q = Q(x=left_vars[1], y=left_vars[2], u=right_vars[1], v=right_vars[2])

    return Q

end

function _orbifold_equivalence_def(f::Type{ThreeVariables.W₁₃{:v1}}, g::Type{ThreeVariables.S₁₁}, left_vars, right_vars)
    R = promote_type(typeof.(left_vars)..., typeof.(right_vars)...)

    # compatibility with copy-pasted notation below
    lookup = Dict(1:6 .=> [right_vars; left_vars])
    x(i) = lookup[i]

    Q = zeros(R, 8, 8)
    let a(i) = A[i], x(i) = lookup[i], (/,//) = (//,/)
        # from https://nms.kcl.ac.uk/andreas.recknagel/oeq-page/defectslistforweb.txt
        Q[1,5]=x(1)*x(6)-x(4);
        Q[1,6]=-x(2)*x(6)^2+x(1)^2+x(2)*x(3);
        Q[1,7]=-x(2)+x(5);
        Q[2,5]=-x(6)^2-x(3);
        Q[2,6]=-x(1)*x(6)-x(4);
        Q[2,8]=-x(2)+x(5);
        Q[3,5]=x(2)^3+x(2)^2*x(5)+x(2)*x(5)^2+x(5)^3-x(3)*x(6)^2;
        Q[3,6]=-x(1)*x(6)^3-x(4)*x(6)^2;
        Q[3,7]=-x(1)*x(6)-x(4);
        Q[3,8]=x(5)*x(6)^2-x(1)^2-x(2)*x(3);
        Q[4,6]=x(6)^4+x(2)^3+x(2)^2*x(5)+x(2)*x(5)^2+x(5)^3;
        Q[4,7]=x(6)^2+x(3);
        Q[4,8]=x(1)*x(6)-x(4);
        Q[5,1]=-x(1)*x(6)-x(4);
        Q[5,2]=x(5)*x(6)^2-x(1)^2-x(2)*x(3);
        Q[5,3]=x(2)-x(5);
        Q[6,1]=x(6)^2+x(3);
        Q[6,2]=x(1)*x(6)-x(4);
        Q[6,4]=x(2)-x(5);
        Q[7,1]=-x(6)^4-x(2)^3-x(2)^2*x(5)-x(2)*x(5)^2-x(5)^3;
        Q[7,2]=-x(1)*x(6)^3+x(4)*x(6)^2;
        Q[7,3]=x(1)*x(6)-x(4);
        Q[7,4]=-x(2)*x(6)^2+x(1)^2+x(2)*x(3);
        Q[8,2]=-x(2)^3-x(2)^2*x(5)-x(2)*x(5)^2-x(5)^3+x(3)*x(6)^2;
        Q[8,3]=-x(6)^2-x(3);
        Q[8,4]=-x(1)*x(6)-x(4);
    end

    # express in the user's variables
    Q = Q(x=left_vars[1], y=left_vars[2], u=right_vars[1], v=right_vars[2])

    return Q
end

function _orbifold_equivalence_def(f::Type{TwoVariables.E₁₃}, g::Type{TwoVariables.Z₁₁}, left_vars, right_vars)
    @warn "This orbifold equivalence is known to contain a loooong computation."
    R = @ring! ℚ[a[1:7]][x,y,u,v]

    # compatibility with notation below
    A = a
    lookup = Dict(1:4 .=> [x,-y,u,v]) # note different sign convention

    # from https://nms.kcl.ac.uk/andreas.recknagel/oeq-page/defectslistforweb.txt
    Q = zeros(R, 6, 6)
    let a(i) = A[i], x(i) = lookup[i], (/,//) = (//,/)
        Q[1,4]=-x(1)^2-x(3)*a(2);
        Q[1,5]=-x(1)*x(4)*a(3)-x(1)*x(4)*a(4)+x(2);
        Q[1,6]=-x(4)*a(4);
        Q[2,4]=x(1)*x(4)*a(3)-x(1)*x(4)*a(5)+x(2);
        Q[2,5]=x(4)^2*a(1)^2*a(4)^2+x(4)^2*a(1)*a(3)*a(4)+x(4)^2*a(1)*a(4)^2+x(4)^2*a(1)*a(4)*a(5)-x(1)^3*a(1)+x(4)^2*a(3)^2+x(4)^2*a(3)*a(4)-x(4)^2*a(3)*a(5)+x(4)^2*a(5)^2+x(1)*x(3)*a(1)*a(2)-x(1)*x(3)*a(1)*a(6)+x(1)^3-x(4)^2*a(7);
        Q[2,6]=x(1)^2+x(3)*a(6);
        Q[3,4]=-x(1)^3*a(1)-x(1)^3-x(4)^2*a(7);
        Q[3,5]=-x(1)^2*x(4)*a(1)^2*a(4)+2*x(3)*x(4)*a(1)^2*a(4)*a(2)-x(1)^2*x(4)*a(1)*a(3)-x(1)^2*x(4)*a(1)*a(4)-x(1)^2*x(4)*a(1)*a(5)+x(3)*x(4)*a(1)*a(3)*a(2)+2*x(3)*x(4)*a(1)*a(4)*a(2)+x(3)*x(4)*a(1)*a(5)*a(2)-x(3)*x(4)*a(1)*a(4)*a(6)-x(1)^2*x(4)*a(3)+x(1)^2*x(4)*a(5)+x(3)*x(4)*a(3)*a(2)-x(3)*x(4)*a(4)*a(6)-x(3)*x(4)*a(5)*a(6)+x(1)*x(2);
        Q[3,6]=x(1)*x(4)*a(5)+x(2);
        Q[4,1]=-x(1)*x(4)^3*a(1)^2*a(4)^2*a(5)-x(1)^4*x(4)*a(1)^2*a(4)-x(1)*x(4)^3*a(1)*a(3)*a(4)*a(5)-x(1)*x(4)^3*a(1)*a(4)^2*a(5)-x(1)*x(4)^3*a(1)*a(4)*a(5)^2+2*x(1)^2*x(3)*x(4)*a(1)^2*a(4)*a(2)-x(1)^2*x(3)*x(4)*a(1)^2*a(4)*a(6)+2*x(3)^2*x(4)*a(1)^2*a(4)*a(2)*a(6)-x(1)^4*x(4)*a(1)*a(3)-x(1)^4*x(4)*a(1)*a(4)-x(2)*x(4)^2*a(1)^2*a(4)^2-x(1)*x(4)^3*a(3)^2*a(5)-x(1)*x(4)^3*a(3)*a(4)*a(5)+x(1)*x(4)^3*a(3)*a(5)^2-x(1)*x(4)^3*a(5)^3+x(1)^2*x(3)*x(4)*a(1)*a(3)*a(2)+2*x(1)^2*x(3)*x(4)*a(1)*a(4)*a(2)-x(1)^2*x(3)*x(4)*a(1)*a(3)*a(6)-2*x(1)^2*x(3)*x(4)*a(1)*a(4)*a(6)+x(3)^2*x(4)*a(1)*a(3)*a(2)*a(6)+2*x(3)^2*x(4)*a(1)*a(4)*a(2)*a(6)+x(3)^2*x(4)*a(1)*a(5)*a(2)*a(6)-x(3)^2*x(4)*a(1)*a(4)*a(6)^2-x(1)^4*x(4)*a(3)-x(2)*x(4)^2*a(1)*a(3)*a(4)-x(2)*x(4)^2*a(1)*a(4)^2-x(2)*x(4)^2*a(1)*a(4)*a(5)+x(1)^2*x(3)*x(4)*a(3)*a(2)-x(1)^2*x(3)*x(4)*a(3)*a(6)-x(1)^2*x(3)*x(4)*a(4)*a(6)+x(3)^2*x(4)*a(3)*a(2)*a(6)-x(3)^2*x(4)*a(4)*a(6)^2-x(3)^2*x(4)*a(5)*a(6)^2+x(1)*x(4)^3*a(5)*a(7)+x(1)^3*x(2)*a(1)-x(2)*x(4)^2*a(3)^2-x(2)*x(4)^2*a(3)*a(4)+x(2)*x(4)^2*a(3)*a(5)-x(2)*x(4)^2*a(5)^2-x(1)*x(2)*x(3)*a(1)*a(2)+x(1)*x(2)*x(3)*a(1)*a(6)+x(1)*x(2)*x(3)*a(6)+x(2)*x(4)^2*a(7);
        Q[4,2]=-x(1)^2*x(4)^2*a(1)^2*a(4)^2-x(3)*x(4)^2*a(1)^2*a(4)^2*a(2)-x(1)^2*x(4)^2*a(1)*a(3)*a(4)-x(1)^2*x(4)^2*a(1)*a(4)^2-x(1)^2*x(4)^2*a(1)*a(4)*a(5)-x(3)*x(4)^2*a(1)*a(3)*a(4)*a(2)-x(3)*x(4)^2*a(1)*a(4)^2*a(2)-x(3)*x(4)^2*a(1)*a(4)*a(5)*a(2)-x(1)^2*x(4)^2*a(3)*a(4)-x(1)^2*x(4)^2*a(3)*a(5)-x(3)*x(4)^2*a(3)^2*a(2)-x(3)*x(4)^2*a(3)*a(4)*a(2)+x(3)*x(4)^2*a(3)*a(5)*a(2)-x(3)*x(4)^2*a(5)^2*a(2)-x(1)*x(3)^2*a(1)*a(2)^2+x(1)*x(3)^2*a(1)*a(2)*a(6)+x(1)*x(3)^2*a(2)*a(6)+x(3)*x(4)^2*a(2)*a(7)-x(3)*x(4)^2*a(6)*a(7)-x(1)*x(2)*x(4)*a(3)+x(1)*x(2)*x(4)*a(5)+x(2)^2;
        Q[4,3]=-x(4)^3*a(1)^2*a(4)^3-x(4)^3*a(1)*a(3)*a(4)^2-x(4)^3*a(1)*a(4)^3-x(4)^3*a(1)*a(4)^2*a(5)+x(1)^3*x(4)*a(1)*a(4)-x(4)^3*a(3)^2*a(4)-x(4)^3*a(3)*a(4)^2+x(4)^3*a(3)*a(4)*a(5)-x(4)^3*a(4)*a(5)^2-x(1)*x(3)*x(4)*a(1)*a(4)*a(2)+x(1)*x(3)*x(4)*a(1)*a(4)*a(6)+x(1)^3*x(4)*a(3)+x(1)*x(3)*x(4)*a(3)*a(6)+x(1)*x(3)*x(4)*a(4)*a(6)+x(4)^3*a(4)*a(7)-x(1)^2*x(2)-x(2)*x(3)*a(6);
        Q[5,1]=-3*x(3)*x(4)^2*a(1)^2*a(4)^2*a(2)-2*x(3)*x(4)^2*a(1)*a(3)*a(4)*a(2)-3*x(3)*x(4)^2*a(1)*a(4)^2*a(2)-2*x(3)*x(4)^2*a(1)*a(4)*a(5)*a(2)+x(3)*x(4)^2*a(1)*a(4)^2*a(6)+x(1)^5*a(1)+x(1)^2*x(4)^2*a(3)*a(5)-x(1)^2*x(4)^2*a(5)^2-x(3)*x(4)^2*a(3)^2*a(2)-2*x(3)*x(4)^2*a(3)*a(4)*a(2)+x(3)*x(4)^2*a(3)*a(5)*a(2)-x(3)*x(4)^2*a(5)^2*a(2)-x(1)*x(3)^2*a(1)*a(2)^2+x(1)^3*x(3)*a(1)*a(6)+x(3)*x(4)^2*a(4)^2*a(6)+x(3)*x(4)^2*a(4)*a(5)*a(6)+x(1)*x(3)^2*a(1)*a(2)*a(6)+x(1)^5+x(1)^3*x(3)*a(6)+x(1)*x(3)^2*a(2)*a(6)+x(1)^2*x(4)^2*a(7)+x(3)*x(4)^2*a(2)*a(7)+x(1)*x(2)*x(4)*a(3)+x(2)^2;
        Q[5,2]=x(1)^3*x(4)*a(1)*a(4)+x(1)^3*x(4)*a(4)+x(1)^3*x(4)*a(5)+x(1)*x(3)*x(4)*a(5)*a(2)+x(4)^3*a(4)*a(7)+x(1)^2*x(2)+x(2)*x(3)*a(2);
        Q[5,3]=x(1)*x(4)^2*a(3)*a(4)-x(1)*x(4)^2*a(4)*a(5)-x(1)^4-x(1)^2*x(3)*a(2)-x(1)^2*x(3)*a(6)-x(3)^2*a(2)*a(6)+x(2)*x(4)*a(4);
        Q[6,1]=-x(1)^3*x(4)^2*a(1)^3*a(4)^2-2*x(1)^3*x(4)^2*a(1)^2*a(4)^2-2*x(1)^3*x(4)^2*a(1)^2*a(4)*a(5)-2*x(1)*x(3)*x(4)^2*a(1)^2*a(3)*a(4)*a(2)+3*x(1)*x(3)*x(4)^2*a(1)^2*a(4)^2*a(2)+2*x(1)*x(3)*x(4)^2*a(1)^2*a(4)*a(5)*a(2)-x(4)^4*a(1)^2*a(4)^2*a(7)+x(1)^6*a(1)^2-x(1)^3*x(4)^2*a(1)*a(3)*a(4)-x(1)^3*x(4)^2*a(1)*a(4)^2+x(1)^3*x(4)^2*a(1)*a(3)*a(5)-2*x(1)^3*x(4)^2*a(1)*a(4)*a(5)-2*x(1)^3*x(4)^2*a(1)*a(5)^2-x(1)^4*x(3)*a(1)^2*a(2)-x(1)*x(3)*x(4)^2*a(1)*a(3)^2*a(2)+3*x(1)*x(3)*x(4)^2*a(1)*a(4)^2*a(2)+4*x(1)*x(3)*x(4)^2*a(1)*a(4)*a(5)*a(2)+x(1)*x(3)*x(4)^2*a(1)*a(5)^2*a(2)+x(1)^4*x(3)*a(1)^2*a(6)+x(1)*x(3)*x(4)^2*a(1)*a(3)*a(4)*a(6)-x(1)*x(3)*x(4)^2*a(1)*a(4)^2*a(6)-x(1)*x(3)*x(4)^2*a(1)*a(4)*a(5)*a(6)-x(4)^4*a(1)*a(3)*a(4)*a(7)-x(4)^4*a(1)*a(4)^2*a(7)-x(4)^4*a(1)*a(4)*a(5)*a(7)+x(1)^2*x(2)*x(4)*a(1)^2*a(4)-x(1)^3*x(4)^2*a(3)*a(4)-x(1)^3*x(4)^2*a(3)*a(5)-x(1)^4*x(3)*a(1)*a(2)-2*x(2)*x(3)*x(4)*a(1)^2*a(4)*a(2)+2*x(1)*x(3)*x(4)^2*a(3)*a(4)*a(2)+x(1)*x(3)*x(4)^2*a(5)^2*a(2)+x(1)^2*x(3)^2*a(1)*a(2)^2+x(1)^4*x(3)*a(1)*a(6)+x(1)*x(3)*x(4)^2*a(3)*a(4)*a(6)-x(1)*x(3)*x(4)^2*a(4)^2*a(6)+x(1)*x(3)*x(4)^2*a(3)*a(5)*a(6)-2*x(1)*x(3)*x(4)^2*a(4)*a(5)*a(6)-x(1)*x(3)*x(4)^2*a(5)^2*a(6)-x(1)^2*x(3)^2*a(1)*a(2)*a(6)+2*x(1)^3*x(4)^2*a(1)*a(7)-x(4)^4*a(3)^2*a(7)-x(4)^4*a(3)*a(4)*a(7)+x(4)^4*a(3)*a(5)*a(7)-x(4)^4*a(5)^2*a(7)-x(1)*x(3)*x(4)^2*a(1)*a(2)*a(7)+x(1)*x(3)*x(4)^2*a(1)*a(6)*a(7)-x(1)^6+x(1)^2*x(2)*x(4)*a(1)*a(3)+x(1)^2*x(2)*x(4)*a(1)*a(4)+x(1)^2*x(2)*x(4)*a(1)*a(5)-x(2)*x(3)*x(4)*a(1)*a(3)*a(2)-2*x(2)*x(3)*x(4)*a(1)*a(4)*a(2)-x(2)*x(3)*x(4)*a(1)*a(5)*a(2)+x(2)*x(3)*x(4)*a(1)*a(4)*a(6)-x(1)^2*x(3)^2*a(2)*a(6)-x(1)*x(3)*x(4)^2*a(2)*a(7)+x(1)*x(3)*x(4)^2*a(6)*a(7)+x(4)^4*a(7)^2-x(2)*x(3)*x(4)*a(3)*a(2)+x(2)*x(3)*x(4)*a(4)*a(6)+x(2)*x(3)*x(4)*a(5)*a(6)-x(1)*x(2)^2;
        Q[6,2]=x(1)^4*x(4)*a(1)^2*a(4)-x(1)^2*x(3)*x(4)*a(1)^2*a(4)*a(2)-2*x(3)^2*x(4)*a(1)^2*a(4)*a(2)^2+x(1)^4*x(4)*a(1)*a(5)-x(1)^2*x(3)*x(4)*a(1)*a(4)*a(2)-x(3)^2*x(4)*a(1)*a(3)*a(2)^2-2*x(3)^2*x(4)*a(1)*a(4)*a(2)^2-x(3)^2*x(4)*a(1)*a(5)*a(2)^2+x(1)^2*x(3)*x(4)*a(1)*a(4)*a(6)+x(3)^2*x(4)*a(1)*a(4)*a(2)*a(6)-x(1)^4*x(4)*a(4)-x(1)^4*x(4)*a(5)-x(1)^2*x(3)*x(4)*a(5)*a(2)-x(3)^2*x(4)*a(3)*a(2)^2+x(1)^2*x(3)*x(4)*a(4)*a(6)+x(1)^2*x(3)*x(4)*a(5)*a(6)+x(3)^2*x(4)*a(4)*a(2)*a(6)+x(3)^2*x(4)*a(5)*a(2)*a(6)-x(1)*x(4)^3*a(3)*a(7)-x(1)*x(4)^3*a(4)*a(7)+x(1)^3*x(2)*a(1)-x(1)*x(2)*x(3)*a(2)+x(2)*x(4)^2*a(7);
        Q[6,3]=x(1)^2*x(4)^2*a(1)^2*a(4)^2-2*x(3)*x(4)^2*a(1)^2*a(4)^2*a(2)+x(1)^2*x(4)^2*a(1)*a(3)*a(4)+x(1)^2*x(4)^2*a(1)*a(4)^2+x(1)^2*x(4)^2*a(1)*a(4)*a(5)-x(3)*x(4)^2*a(1)*a(3)*a(4)*a(2)-2*x(3)*x(4)^2*a(1)*a(4)^2*a(2)-x(3)*x(4)^2*a(1)*a(4)*a(5)*a(2)+x(3)*x(4)^2*a(1)*a(4)^2*a(6)-x(1)^5*a(1)+x(1)^2*x(4)^2*a(4)*a(5)+x(1)^2*x(4)^2*a(5)^2-x(3)*x(4)^2*a(3)*a(4)*a(2)-x(1)^3*x(3)*a(1)*a(6)+x(3)*x(4)^2*a(4)^2*a(6)+x(3)*x(4)^2*a(4)*a(5)*a(6)+x(1)^5+x(1)^3*x(3)*a(2)+x(1)*x(3)^2*a(2)*a(6)-x(1)^2*x(4)^2*a(7)-x(3)*x(4)^2*a(6)*a(7)-x(1)*x(2)*x(4)*a(4)-x(1)*x(2)*x(4)*a(5)+x(2)^2;
    end

    Q = materialize_ansatz(Q, g(u,v) - f(x,y), :x, :y, :u, :v)

    # express in the user's variables
    Q = Q(x=left_vars[1], y=left_vars[2], u=right_vars[1], v=right_vars[2])

    return Q
end

function _orbifold_equivalence_def(f::Type{ThreeVariables.Q₁₁}, g::Type{ThreeVariables.Z₁₃{:v1}}, left_vars, right_vars)
    R = @ring! ℚ[a[1:5]][x,y,z,u,v,w]

    # compatibility with notation below
    lookup = Dict(1:6 .=> [u,v,w,x,y,z])
    A = a

    Q = zeros(R, 12, 12)
    let a(i) = A[i], x(i) = lookup[i], (/,//) = (//,/)
        # from https://nms.kcl.ac.uk/andreas.recknagel/oeq-page/defectslistforweb.txt
        Q[1,7]=2*x(6)*a(1)^2*a(2)+2*x(6)*a(1)*a(3);
        Q[1,8]=-3/2*x(1)^3*a(1)^3*a(2)^3-x(1)^3*a(1)^2*a(3)*a(2)^2+1/2*x(1)^3*a(1)*a(3)^2*a(2)+2*x(2)*x(6)*a(4)*a(1)^2*a(2)+2*x(2)*x(6)*a(4)*a(1)*a(3)-x(2)*x(6)*a(1)+x(1)*x(5)*a(3)+x(3);
        Q[1,10]=-3/8*x(1)^2*a(4)*a(1)^3*a(2)^3-1/4*x(1)^2*a(4)*a(1)^2*a(3)*a(2)^2+1/8*x(1)^2*a(4)*a(1)*a(3)^2*a(2)+1/4*x(1)^2*a(3)^2-x(5);
        Q[1,11]=-x(2);
        Q[2,7]=3/2*x(1)^3*a(1)^3*a(2)^3+x(1)^3*a(1)^2*a(3)*a(2)^2-1/2*x(1)^3*a(1)*a(3)^2*a(2)+x(2)*x(6)*a(1)-x(1)*x(5)*a(3)+x(3);
        Q[2,8]=3/4*x(1)^3*x(2)*a(4)*a(1)^3*a(2)^3-x(1)^2*x(6)^2*a(1)^4*a(2)^2+1/2*x(1)^3*x(2)*a(4)*a(1)^2*a(3)*a(2)^2-x(1)^2*x(6)^2*a(1)^3*a(3)*a(2)-1/4*x(1)^3*x(2)*a(4)*a(1)*a(3)^2*a(2)-1/2*x(1)^3*x(2)*a(3)^2+x(2)^2*x(6)*a(4)*a(1)+x(5)*x(6)^2*a(1)^2-x(1)*x(2)*x(5)*a(4)*a(3)+1/2*x(1)^2*x(6)^2*a(2)-x(4)^2*a(5)^2+x(1)*x(2)*x(5)+x(2)*x(3)*a(4);
        Q[2,9]=9/32*x(1)^4*a(4)^2*a(1)^6*a(2)^6+3/8*x(1)^4*a(4)^2*a(1)^5*a(3)*a(2)^5-1/16*x(1)^4*a(4)^2*a(1)^4*a(3)^2*a(2)^4-1/8*x(1)^4*a(4)^2*a(1)^3*a(3)^3*a(2)^3+1/32*x(1)^4*a(4)^2*a(1)^2*a(3)^4*a(2)^2+3/8*x(1)^2*x(5)*a(4)*a(1)^3*a(2)^3+1/4*x(1)^2*x(5)*a(4)*a(1)^2*a(3)*a(2)^2-1/8*x(1)^4*a(3)^4-1/8*x(1)^2*x(5)*a(4)*a(1)*a(3)^2*a(2)+x(1)*x(2)*x(6)*a(1)^2*a(2)+3/4*x(1)^2*x(5)*a(3)^2+x(2)*x(4)*a(5)-x(5)^2;
        Q[2,12]=1/2*x(1)^3*x(6)*a(1)^4*a(2)^3-3/8*x(1)^2*x(4)*a(4)*a(1)^3*a(5)*a(2)^3-1/4*x(1)^2*x(4)*a(4)*a(1)^2*a(3)*a(5)*a(2)^2-1/2*x(1)^3*x(6)*a(1)^2*a(3)^2*a(2)+1/8*x(1)^2*x(4)*a(4)*a(1)*a(3)^2*a(5)*a(2)+1/4*x(1)^2*x(4)*a(3)^2*a(5)+x(1)*x(5)*x(6)*a(1)^2*a(2)+x(2)*x(6)^2*a(1)^2+x(1)*x(2)^2-x(4)*x(5)*a(5);
        Q[3,8]=9/32*x(1)^4*a(4)^2*a(1)^6*a(2)^6+3/8*x(1)^4*a(4)^2*a(1)^5*a(3)*a(2)^5-1/16*x(1)^4*a(4)^2*a(1)^4*a(3)^2*a(2)^4-1/8*x(1)^4*a(4)^2*a(1)^3*a(3)^3*a(2)^3+1/32*x(1)^4*a(4)^2*a(1)^2*a(3)^4*a(2)^2+3/8*x(1)^2*x(5)*a(4)*a(1)^3*a(2)^3+1/4*x(1)^2*x(5)*a(4)*a(1)^2*a(3)*a(2)^2-1/8*x(1)^4*a(3)^4-1/8*x(1)^2*x(5)*a(4)*a(1)*a(3)^2*a(2)+x(1)*x(2)*x(6)*a(1)^2*a(2)+3/4*x(1)^2*x(5)*a(3)^2-x(2)*x(4)*a(5)-x(5)^2;
        Q[3,9]=-3/4*x(1)^2*x(6)*a(4)*a(1)^5*a(2)^4-1/2*x(1)^2*x(6)*a(4)*a(1)^4*a(3)*a(2)^3+1/4*x(1)^2*x(6)*a(4)*a(1)^3*a(3)^2*a(2)^2+3*x(1)^2*x(6)*a(1)^4*a(2)^3+2*x(1)^2*x(6)*a(1)^3*a(3)*a(2)^2-1/2*x(1)^2*x(6)*a(1)^2*a(3)^2*a(2)-2*x(5)*x(6)*a(1)^2*a(2)-2*x(5)*x(6)*a(1)*a(3)+x(2)^2;
        Q[3,10]=3/2*x(1)^3*a(1)^3*a(2)^3+x(1)^3*a(1)^2*a(3)*a(2)^2-1/2*x(1)^3*a(1)*a(3)^2*a(2)+x(2)*x(6)*a(1)-x(1)*x(5)*a(3)+x(3);
        Q[3,12]=-3/8*x(1)^2*x(2)*a(4)*a(1)^3*a(2)^3+2*x(1)*x(6)^2*a(1)^4*a(2)^2-1/4*x(1)^2*x(2)*a(4)*a(1)^2*a(3)*a(2)^2+2*x(1)*x(6)^2*a(1)^3*a(3)*a(2)+1/8*x(1)^2*x(2)*a(4)*a(1)*a(3)^2*a(2)-2*x(4)*x(6)*a(1)^2*a(5)*a(2)+1/4*x(1)^2*x(2)*a(3)^2-2*x(4)*x(6)*a(1)*a(3)*a(5)-x(2)*x(5);
        Q[4,7]=-3/8*x(1)^2*a(4)*a(1)^3*a(2)^3-1/4*x(1)^2*a(4)*a(1)^2*a(3)*a(2)^2+1/8*x(1)^2*a(4)*a(1)*a(3)^2*a(2)+1/4*x(1)^2*a(3)^2-x(5);
        Q[4,8]=-3/8*x(1)^2*x(2)*a(4)^2*a(1)^3*a(2)^3-1/4*x(1)^2*x(2)*a(4)^2*a(1)^2*a(3)*a(2)^2+1/8*x(1)^2*x(2)*a(4)^2*a(1)*a(3)^2*a(2)+1/4*x(1)^2*x(2)*a(4)*a(3)^2-x(2)*x(5)*a(4);
        Q[4,9]=-3/2*x(1)^3*a(1)^3*a(2)^3-x(1)^3*a(1)^2*a(3)*a(2)^2+1/2*x(1)^3*a(1)*a(3)^2*a(2)-x(2)*x(6)*a(1)+x(1)*x(5)*a(3)+x(3);
        Q[4,10]=-x(6)^2*a(1)^2-x(1)*x(2);
        Q[4,11]=x(1)*x(6)*a(1)^2*a(2)-x(4)*a(5);
        Q[5,7]=-x(2);
        Q[5,8]=-x(2)^2*a(4);
        Q[5,10]=x(1)*x(6)*a(1)^2*a(2)+x(4)*a(5);
        Q[5,11]=-x(1)^2*a(1)^2*a(2)^2+x(5);
        Q[5,12]=-3/2*x(1)^3*a(1)^3*a(2)^3-x(1)^3*a(1)^2*a(3)*a(2)^2+1/2*x(1)^3*a(1)*a(3)^2*a(2)-x(2)*x(6)*a(1)+x(1)*x(5)*a(3)+x(3);
        Q[6,7]=-x(1)*x(2)*a(3);
        Q[6,8]=1/2*x(1)^3*x(6)*a(1)^4*a(2)^3+3/8*x(1)^2*x(4)*a(4)*a(1)^3*a(5)*a(2)^3+1/4*x(1)^2*x(4)*a(4)*a(1)^2*a(3)*a(5)*a(2)^2-1/2*x(1)^3*x(6)*a(1)^2*a(3)^2*a(2)-1/8*x(1)^2*x(4)*a(4)*a(1)*a(3)^2*a(5)*a(2)-1/4*x(1)^2*x(4)*a(3)^2*a(5)+x(1)*x(5)*x(6)*a(1)^2*a(2)+x(2)*x(6)^2*a(1)^2-x(1)*x(2)^2*a(4)*a(3)+x(1)*x(2)^2+x(4)*x(5)*a(5);
        Q[6,9]=-3/8*x(1)^2*x(2)*a(4)*a(1)^3*a(2)^3-1/4*x(1)^2*x(2)*a(4)*a(1)^2*a(3)*a(2)^2+1/8*x(1)^2*x(2)*a(4)*a(1)*a(3)^2*a(2)+2*x(4)*x(6)*a(1)^2*a(5)*a(2)+1/4*x(1)^2*x(2)*a(3)^2+2*x(4)*x(6)*a(1)*a(3)*a(5)+x(1)*x(6)^2*a(2)-x(2)*x(5);
        Q[6,10]=x(1)^2*x(6)*a(1)^2*a(3)*a(2)+x(1)*x(4)*a(3)*a(5);
        Q[6,11]=3/2*x(1)^3*a(1)^3*a(2)^3-1/2*x(1)^3*a(1)*a(3)^2*a(2)+x(2)*x(6)*a(1)+x(3);
        Q[6,12]=x(1)^4*a(1)^4*a(2)^4+3/2*x(1)^4*a(1)^3*a(3)*a(2)^3-1/2*x(1)^4*a(1)*a(3)^3*a(2)+2*x(6)^3*a(1)^4*a(2)+2*x(6)^3*a(1)^3*a(3)+x(1)^2*x(5)*a(1)^2*a(2)^2+2*x(1)*x(2)*x(6)*a(1)^2*a(2)+x(1)*x(2)*x(6)*a(1)*a(3)+x(1)*x(3)*a(3)+x(5)^2;
        Q[7,1]=-3/4*x(1)^3*x(2)*a(4)*a(1)^3*a(2)^3+x(1)^2*x(6)^2*a(1)^4*a(2)^2-1/2*x(1)^3*x(2)*a(4)*a(1)^2*a(3)*a(2)^2+x(1)^2*x(6)^2*a(1)^3*a(3)*a(2)+1/4*x(1)^3*x(2)*a(4)*a(1)*a(3)^2*a(2)+1/2*x(1)^3*x(2)*a(3)^2-x(2)^2*x(6)*a(4)*a(1)-x(5)*x(6)^2*a(1)^2+x(1)*x(2)*x(5)*a(4)*a(3)-1/2*x(1)^2*x(6)^2*a(2)+x(4)^2*a(5)^2-x(1)*x(2)*x(5)-x(2)*x(3)*a(4);
        Q[7,2]=-3/2*x(1)^3*a(1)^3*a(2)^3-x(1)^3*a(1)^2*a(3)*a(2)^2+1/2*x(1)^3*a(1)*a(3)^2*a(2)+2*x(2)*x(6)*a(4)*a(1)^2*a(2)+2*x(2)*x(6)*a(4)*a(1)*a(3)-x(2)*x(6)*a(1)+x(1)*x(5)*a(3)+x(3);
        Q[7,3]=-3/8*x(1)^2*x(2)*a(4)^2*a(1)^3*a(2)^3-1/4*x(1)^2*x(2)*a(4)^2*a(1)^2*a(3)*a(2)^2+1/8*x(1)^2*x(2)*a(4)^2*a(1)*a(3)^2*a(2)+1/4*x(1)^2*x(2)*a(4)*a(3)^2-x(2)*x(5)*a(4);
        Q[7,4]=-9/32*x(1)^4*a(4)^2*a(1)^6*a(2)^6-3/8*x(1)^4*a(4)^2*a(1)^5*a(3)*a(2)^5+1/16*x(1)^4*a(4)^2*a(1)^4*a(3)^2*a(2)^4+1/8*x(1)^4*a(4)^2*a(1)^3*a(3)^3*a(2)^3-1/32*x(1)^4*a(4)^2*a(1)^2*a(3)^4*a(2)^2-3/8*x(1)^2*x(5)*a(4)*a(1)^3*a(2)^3-1/4*x(1)^2*x(5)*a(4)*a(1)^2*a(3)*a(2)^2+1/8*x(1)^4*a(3)^4+1/8*x(1)^2*x(5)*a(4)*a(1)*a(3)^2*a(2)-x(1)*x(2)*x(6)*a(1)^2*a(2)-3/4*x(1)^2*x(5)*a(3)^2-x(2)*x(4)*a(5)+x(5)^2;
        Q[7,5]=-1/2*x(1)^3*x(6)*a(1)^4*a(2)^3+3/8*x(1)^2*x(4)*a(4)*a(1)^3*a(5)*a(2)^3+1/4*x(1)^2*x(4)*a(4)*a(1)^2*a(3)*a(5)*a(2)^2+1/2*x(1)^3*x(6)*a(1)^2*a(3)^2*a(2)-1/8*x(1)^2*x(4)*a(4)*a(1)*a(3)^2*a(5)*a(2)-1/4*x(1)^2*x(4)*a(3)^2*a(5)-x(1)*x(5)*x(6)*a(1)^2*a(2)-x(2)*x(6)^2*a(1)^2+x(1)*x(2)^2*a(4)*a(3)-x(1)*x(2)^2+x(4)*x(5)*a(5);
        Q[7,6]=-x(2)^2*a(4);
        Q[8,1]=3/2*x(1)^3*a(1)^3*a(2)^3+x(1)^3*a(1)^2*a(3)*a(2)^2-1/2*x(1)^3*a(1)*a(3)^2*a(2)+x(2)*x(6)*a(1)-x(1)*x(5)*a(3)+x(3);
        Q[8,2]=-2*x(6)*a(1)^2*a(2)-2*x(6)*a(1)*a(3);
        Q[8,3]=3/8*x(1)^2*a(4)*a(1)^3*a(2)^3+1/4*x(1)^2*a(4)*a(1)^2*a(3)*a(2)^2-1/8*x(1)^2*a(4)*a(1)*a(3)^2*a(2)-1/4*x(1)^2*a(3)^2+x(5);
        Q[8,5]=-x(1)*x(2)*a(3);
        Q[8,6]=x(2);
        Q[9,2]=3/8*x(1)^2*a(4)*a(1)^3*a(2)^3+1/4*x(1)^2*a(4)*a(1)^2*a(3)*a(2)^2-1/8*x(1)^2*a(4)*a(1)*a(3)^2*a(2)-1/4*x(1)^2*a(3)^2+x(5);
        Q[9,3]=x(6)^2*a(1)^2+x(1)*x(2);
        Q[9,4]=3/2*x(1)^3*a(1)^3*a(2)^3+x(1)^3*a(1)^2*a(3)*a(2)^2-1/2*x(1)^3*a(1)*a(3)^2*a(2)+x(2)*x(6)*a(1)-x(1)*x(5)*a(3)+x(3);
        Q[9,5]=x(1)^2*x(6)*a(1)^2*a(3)*a(2)-x(1)*x(4)*a(3)*a(5);
        Q[9,6]=-x(1)*x(6)*a(1)^2*a(2)+x(4)*a(5);
        Q[10,1]=-9/32*x(1)^4*a(4)^2*a(1)^6*a(2)^6-3/8*x(1)^4*a(4)^2*a(1)^5*a(3)*a(2)^5+1/16*x(1)^4*a(4)^2*a(1)^4*a(3)^2*a(2)^4+1/8*x(1)^4*a(4)^2*a(1)^3*a(3)^3*a(2)^3-1/32*x(1)^4*a(4)^2*a(1)^2*a(3)^4*a(2)^2-3/8*x(1)^2*x(5)*a(4)*a(1)^3*a(2)^3-1/4*x(1)^2*x(5)*a(4)*a(1)^2*a(3)*a(2)^2+1/8*x(1)^4*a(3)^4+1/8*x(1)^2*x(5)*a(4)*a(1)*a(3)^2*a(2)-x(1)*x(2)*x(6)*a(1)^2*a(2)-3/4*x(1)^2*x(5)*a(3)^2+x(2)*x(4)*a(5)+x(5)^2;
        Q[10,3]=-3/2*x(1)^3*a(1)^3*a(2)^3-x(1)^3*a(1)^2*a(3)*a(2)^2+1/2*x(1)^3*a(1)*a(3)^2*a(2)-x(2)*x(6)*a(1)+x(1)*x(5)*a(3)+x(3);
        Q[10,4]=3/4*x(1)^2*x(6)*a(4)*a(1)^5*a(2)^4+1/2*x(1)^2*x(6)*a(4)*a(1)^4*a(3)*a(2)^3-1/4*x(1)^2*x(6)*a(4)*a(1)^3*a(3)^2*a(2)^2-3*x(1)^2*x(6)*a(1)^4*a(2)^3-2*x(1)^2*x(6)*a(1)^3*a(3)*a(2)^2+1/2*x(1)^2*x(6)*a(1)^2*a(3)^2*a(2)+2*x(5)*x(6)*a(1)^2*a(2)+2*x(5)*x(6)*a(1)*a(3)-x(2)^2;
        Q[10,5]=3/8*x(1)^2*x(2)*a(4)*a(1)^3*a(2)^3-2*x(1)*x(6)^2*a(1)^4*a(2)^2+1/4*x(1)^2*x(2)*a(4)*a(1)^2*a(3)*a(2)^2-2*x(1)*x(6)^2*a(1)^3*a(3)*a(2)-1/8*x(1)^2*x(2)*a(4)*a(1)*a(3)^2*a(2)+2*x(4)*x(6)*a(1)^2*a(5)*a(2)-1/4*x(1)^2*x(2)*a(3)^2+2*x(4)*x(6)*a(1)*a(3)*a(5)+x(2)*x(5);
        Q[11,1]=-1/2*x(1)^3*x(6)*a(1)^4*a(2)^3-3/8*x(1)^2*x(4)*a(4)*a(1)^3*a(5)*a(2)^3-1/4*x(1)^2*x(4)*a(4)*a(1)^2*a(3)*a(5)*a(2)^2+1/2*x(1)^3*x(6)*a(1)^2*a(3)^2*a(2)+1/8*x(1)^2*x(4)*a(4)*a(1)*a(3)^2*a(5)*a(2)+1/4*x(1)^2*x(4)*a(3)^2*a(5)-x(1)*x(5)*x(6)*a(1)^2*a(2)-x(2)*x(6)^2*a(1)^2-x(1)*x(2)^2-x(4)*x(5)*a(5);
        Q[11,4]=3/8*x(1)^2*x(2)*a(4)*a(1)^3*a(2)^3+1/4*x(1)^2*x(2)*a(4)*a(1)^2*a(3)*a(2)^2-1/8*x(1)^2*x(2)*a(4)*a(1)*a(3)^2*a(2)-2*x(4)*x(6)*a(1)^2*a(5)*a(2)-1/4*x(1)^2*x(2)*a(3)^2-2*x(4)*x(6)*a(1)*a(3)*a(5)-x(1)*x(6)^2*a(2)+x(2)*x(5);
        Q[11,5]=-x(1)^4*a(1)^4*a(2)^4-3/2*x(1)^4*a(1)^3*a(3)*a(2)^3+1/2*x(1)^4*a(1)*a(3)^3*a(2)-2*x(6)^3*a(1)^4*a(2)-2*x(6)^3*a(1)^3*a(3)-x(1)^2*x(5)*a(1)^2*a(2)^2-2*x(1)*x(2)*x(6)*a(1)^2*a(2)-x(1)*x(2)*x(6)*a(1)*a(3)-x(1)*x(3)*a(3)-x(5)^2;
        Q[11,6]=-3/2*x(1)^3*a(1)^3*a(2)^3-x(1)^3*a(1)^2*a(3)*a(2)^2+1/2*x(1)^3*a(1)*a(3)^2*a(2)-x(2)*x(6)*a(1)+x(1)*x(5)*a(3)+x(3);
        Q[12,2]=x(2);
        Q[12,3]=-x(1)*x(6)*a(1)^2*a(2)-x(4)*a(5);
        Q[12,5]=3/2*x(1)^3*a(1)^3*a(2)^3-1/2*x(1)^3*a(1)*a(3)^2*a(2)+x(2)*x(6)*a(1)+x(3);
        Q[12,6]=x(1)^2*a(1)^2*a(2)^2-x(5);
    end

    Q = materialize_ansatz(Q, g(u,v,w) - f(x,y,z), :x, :y, :z, :u, :v, :w)

    # express in the user's variables
    Q = Q(x=left_vars[1], y=left_vars[2], z=left_vars[3], u=right_vars[1], v=right_vars[2], w=right_vars[3])

    return Q
end
